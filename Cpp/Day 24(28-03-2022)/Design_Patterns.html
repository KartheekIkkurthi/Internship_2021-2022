<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>C++ Programming: Code patterns design - Wikibooks, open books for an open world</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"1adc0cd7-ce19-4477-a7ef-999be73c24a6","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"C++_Programming/Code/Design_Patterns","wgTitle":"C++ Programming/Code/Design Patterns","wgCurRevisionId":3520978,"wgRevisionId":3520978,"wgArticleId":54848,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Wikibooks pages with to-do lists","Pages needing sources","Book:C++ Programming"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"C++_Programming/Code/Design_Patterns","wgRelevantArticleId":54848,"wgIsProbablyEditable":true
,"wgRelevantPageIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgFlaggedRevsParams":{"tags":{"value":{"levels":3}}},"wgStableRevisionId":3520978,"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgMFDisplayWikibaseDescriptions":{"search":true,"nearby":true,"watchlist":true,"tagline":false},"wgWMESchemaEditAttemptStepOversample":false,"wgWMEPageLength":4000,"wgNoticeProject":"wikibooks","wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgULSCurrentAutonym":"English","wgEditSubmitButtonLabelPublish":true,"wgCentralAuthMobileDomain":false,"wgULSPosition":"interlanguage","wgULSisCompactLinksEnabled":true,"wgSiteNoticeId":"2.24"};RLSTATE={"ext.globalCssJs.user.styles":"ready","site.styles":"ready","user.styles":"ready","ext.globalCssJs.user":"ready","user":"ready","user.options":"loading","ext.flaggedRevs.icons":"ready","oojs-ui-core.styles":"ready","oojs-ui.styles.indicators":"ready",
"mediawiki.widgets.styles":"ready","oojs-ui-core.icons":"ready","ext.pygments":"ready","skins.vector.styles.legacy":"ready","ext.flaggedRevs.basic":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.wikimediaBadges":"ready","ext.uls.interlanguage":"ready","wikibase.client.init":"ready","ext.dismissableSiteNotice.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.js","ext.flaggedRevs.advanced","ext.gadget.wikidialog","ext.gadget.commons-file","mmv.head","mmv.bootstrap.autostart","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","ext.eventLogging","ext.wikimediaEvents","ext.navigationTiming","ext.centralNotice.geoIP","ext.centralNotice.startUp","ext.centralauth.centralautologin","ext.uls.compactlinks","ext.uls.interface","ext.dismissableSiteNotice"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1i9g4",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});</script>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=ext.dismissableSiteNotice.styles%7Cext.flaggedRevs.basic%2Cicons%7Cext.pygments%2CwikimediaBadges%7Cext.uls.interlanguage%7Cext.visualEditor.desktopArticleTarget.noscript%7Cmediawiki.widgets.styles%7Coojs-ui-core.icons%2Cstyles%7Coojs-ui.styles.indicators%7Cskins.vector.styles.legacy%7Cwikibase.client.init&amp;only=styles&amp;skin=vector"/>
<script async="" src="/w/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.39.0-wmf.4"/>
<meta name="referrer" content="origin"/>
<meta name="referrer" content="origin-when-crossorigin"/>
<meta name="referrer" content="origin-when-cross-origin"/>
<meta name="format-detection" content="telephone=no"/>
<meta property="og:title" content="C++ Programming: Code patterns design - Wikibooks, open books for an open world"/>
<meta property="og:type" content="website"/>
<link rel="preconnect" href="//upload.wikimedia.org"/>
<link rel="alternate" media="only screen and (max-width: 720px)" href="//en.m.wikibooks.org/wiki/C%2B%2B_Programming/Code/Design_Patterns"/>
<link rel="alternate" type="application/x-wiki" title="Edit" href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;action=edit"/>
<link rel="shortcut icon" href="/static/favicon/wikibooks.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikibooks (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="//en.wikibooks.org/w/api.php?action=rsd"/>
<link rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="canonical" href="https://en.wikibooks.org/wiki/C%2B%2B_Programming/Code/Design_Patterns"/>
<link rel="dns-prefetch" href="//meta.wikimedia.org" />
<link rel="dns-prefetch" href="//login.wikimedia.org"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject mw-editable page-C_Programming_Code_Design_Patterns rootpage-C_Programming skin-vector action-view skin-vector-legacy"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"><!-- CentralNotice --><div id="mw-dismissablenotice-anonplace"></div><script>(function(){var node=document.getElementById("mw-dismissablenotice-anonplace");if(node){node.outerHTML="\u003Cdiv class=\"mw-dismissable-notice\"\u003E\u003Cdiv class=\"mw-dismissable-notice-close\"\u003E[\u003Ca tabindex=\"0\" role=\"button\"\u003Edismiss\u003C/a\u003E]\u003C/div\u003E\u003Cdiv class=\"mw-dismissable-notice-body\"\u003E\u003Cdiv id=\"localNotice\"\u003E\u003Cdiv class=\"anonnotice\" lang=\"en\" dir=\"ltr\"\u003E\u003Cdiv style=\"background: #ffffff; border: solid 1px #48b; width: auto; padding-left:2px; padding-right:2px; margin-left:auto; margin-right:auto; vertical-align: top; display:table; color:black;\"\u003EThe Wikibooks community has accepted \u003Ca href=\"/wiki/Wikibooks:Reading_room/Proposals#Implementation\" title=\"Wikibooks:Reading room/Proposals\"\u003Evideo game strategy guides\u003C/a\u003E on this wiki! See \u003Ca href=\"/wiki/Wikibooks:Strategy_guides\" title=\"Wikibooks:Strategy guides\"\u003EWikibooks:Strategy guides\u003C/a\u003E for the newly-created policy on strategy games. We're looking forward to your contributions.\n\u003C/div\u003E\u003C/div\u003E\u003C/div\u003E\u003C/div\u003E\u003C/div\u003E";}}());</script></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading">C++ Programming: Code patterns design</h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Wikibooks, open books for an open world</div>
		<div id="contentSub"><span class="subpages">&lt; <a href="/wiki/C%2B%2B_Programming" title="C++ Programming">C++ Programming</a></span></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Programming_Patterns"><span class="tocnumber">1</span> <span class="toctext">Programming Patterns</span></a></li>
<li class="toclevel-1"><a href="#Creational_Patterns"><span class="tocnumber">2</span> <span class="toctext">Creational Patterns</span></a>
<ul>
<li class="toclevel-2"><a href="#Builder"><span class="tocnumber">2.1</span> <span class="toctext">Builder</span></a></li>
<li class="toclevel-2"><a href="#Factory"><span class="tocnumber">2.2</span> <span class="toctext">Factory</span></a></li>
<li class="toclevel-2"><a href="#Abstract_Factory"><span class="tocnumber">2.3</span> <span class="toctext">Abstract Factory</span></a></li>
<li class="toclevel-2"><a href="#Prototype"><span class="tocnumber">2.4</span> <span class="toctext">Prototype</span></a></li>
<li class="toclevel-2"><a href="#Singleton"><span class="tocnumber">2.5</span> <span class="toctext">Singleton</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Structural_Patterns"><span class="tocnumber">3</span> <span class="toctext">Structural Patterns</span></a>
<ul>
<li class="toclevel-2"><a href="#Adapter"><span class="tocnumber">3.1</span> <span class="toctext">Adapter</span></a></li>
<li class="toclevel-2"><a href="#Bridge"><span class="tocnumber">3.2</span> <span class="toctext">Bridge</span></a></li>
<li class="toclevel-2"><a href="#Composite"><span class="tocnumber">3.3</span> <span class="toctext">Composite</span></a></li>
<li class="toclevel-2"><a href="#Decorator"><span class="tocnumber">3.4</span> <span class="toctext">Decorator</span></a></li>
<li class="toclevel-2"><a href="#Facade"><span class="tocnumber">3.5</span> <span class="toctext">Facade</span></a></li>
<li class="toclevel-2"><a href="#Flyweight"><span class="tocnumber">3.6</span> <span class="toctext">Flyweight</span></a></li>
<li class="toclevel-2"><a href="#Proxy"><span class="tocnumber">3.7</span> <span class="toctext">Proxy</span></a></li>
<li class="toclevel-2"><a href="#Curiously_Recurring_Template"><span class="tocnumber">3.8</span> <span class="toctext">Curiously Recurring Template</span></a></li>
<li class="toclevel-2"><a href="#Interface-based_Programming_(IBP)"><span class="tocnumber">3.9</span> <span class="toctext">Interface-based Programming (IBP)</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Behavioral_Patterns"><span class="tocnumber">4</span> <span class="toctext">Behavioral Patterns</span></a>
<ul>
<li class="toclevel-2"><a href="#Chain_of_Responsibility"><span class="tocnumber">4.1</span> <span class="toctext">Chain of Responsibility</span></a></li>
<li class="toclevel-2"><a href="#Command"><span class="tocnumber">4.2</span> <span class="toctext">Command</span></a></li>
<li class="toclevel-2"><a href="#Interpreter"><span class="tocnumber">4.3</span> <span class="toctext">Interpreter</span></a></li>
<li class="toclevel-2"><a href="#Iterator"><span class="tocnumber">4.4</span> <span class="toctext">Iterator</span></a></li>
<li class="toclevel-2"><a href="#Mediator"><span class="tocnumber">4.5</span> <span class="toctext">Mediator</span></a></li>
<li class="toclevel-2"><a href="#Memento"><span class="tocnumber">4.6</span> <span class="toctext">Memento</span></a></li>
<li class="toclevel-2"><a href="#Observer"><span class="tocnumber">4.7</span> <span class="toctext">Observer</span></a></li>
<li class="toclevel-2"><a href="#State"><span class="tocnumber">4.8</span> <span class="toctext">State</span></a></li>
<li class="toclevel-2"><a href="#Strategy"><span class="tocnumber">4.9</span> <span class="toctext">Strategy</span></a></li>
<li class="toclevel-2"><a href="#Template_Method"><span class="tocnumber">4.10</span> <span class="toctext">Template Method</span></a></li>
<li class="toclevel-2"><a href="#Visitor"><span class="tocnumber">4.11</span> <span class="toctext">Visitor</span></a></li>
<li class="toclevel-2"><a href="#Model-View-Controller_(MVC)"><span class="tocnumber">4.12</span> <span class="toctext">Model-View-Controller (MVC)</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Programming_Patterns">Programming Patterns</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;veaction=edit&amp;section=1" class="mw-editsection-visualeditor" title="Edit section: Programming Patterns">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;action=edit&amp;section=1" title="Edit section: Programming Patterns">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="notice metadata" id="cleanup" style="background:#F9F9F9; border:1px solid #aaaaaa; padding:6pt; font-family:monospace; margin:12pt 8%; width:84%">
<p>"To understand is to perceive patterns"
</p>
<hr />
<div style="font-family:serif; font-weight:bold;">â€”<a href="https://en.wikipedia.org/wiki/Isaiah_Berlin" class="extiw" title="w:Isaiah Berlin">Isaiah Berlin</a></div>
</div>
<p>Software design patterns are abstractions that help structure system designs. While not new, since the concept was already described by <a href="https://en.wikipedia.org/wiki/Christopher_Alexander" class="extiw" title="w:Christopher Alexander">Christopher Alexander</a> in its architectural theories, it only gathered some traction in programming due to the publication of <a href="https://en.wikipedia.org/wiki/Design_Patterns" class="extiw" title="w:Design Patterns">Design Patterns: Elements of Reusable Object-Oriented Software</a> book in October 1994 by <a href="https://en.wikipedia.org/wiki/Erich_Gamma" class="extiw" title="w:Erich Gamma">Erich Gamma</a>, <a href="https://en.wikipedia.org/wiki/Richard_Helm" class="extiw" title="w:Richard Helm">Richard Helm</a>, <a href="https://en.wikipedia.org/wiki/Ralph_Johnson" class="extiw" title="w:Ralph Johnson">Ralph Johnson</a> and <a href="https://en.wikipedia.org/wiki/John_Vlissides" class="extiw" title="w:John Vlissides">John Vlissides</a>, known as the <b><a href="https://en.wikipedia.org/wiki/Design_Patterns" class="extiw" title="wikipedia:Design Patterns">Gang of Four (GoF)</a></b>, that identifies and describes 23 classic software design patterns.
</p><p>A design pattern is neither a static solution, nor is it an algorithm. A <b>pattern</b> is a way to describe and address by name a repeatable solution or approach to a common design problem, that is, a common way to solve a generic problem (how generic or specific the pattern is depends on how restricted the target goal is). Patterns can emerge on their own or by design. This is why design patterns are useful as an abstraction over the implementation and a help at design stage. With this concept, an easier way to facilitate communication over a design choice as normalization technique is given so that every person can share the design concept.
</p><p>Depending on the design problem they address, design patterns can be classified in different categories, of which the main categories are:
</p>
<ul><li><a href="/wiki/C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns" title="C++ Programming/Code/Design Patterns/Creational Patterns">Creational Patterns</a></li>
<li><a href="/wiki/C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns" title="C++ Programming/Code/Design Patterns/Structural Patterns">Structural Patterns</a></li>
<li><a href="/wiki/C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns" title="C++ Programming/Code/Design Patterns/Behavioral Patterns">Behavioral Patterns</a>.</li></ul>
<p>Patterns are commonly found in objected-oriented programming languages like C++ or Java. They can be seen as a template for how to solve a problem that occurs in many different situations or applications. It is not code reuse, as it usually does not specify code, but code can be easily created from a design pattern. Object-oriented design patterns typically show relationships and interactions between classes or objects without specifying the final application classes or objects that are involved.
</p><p>Each design pattern consists of the following parts:
</p>
<dl><dt>Problem/requirement</dt>
<dd>To use a design pattern, we need to go through a mini analysis design that may be coded to test out the solution.  This section states the requirements of the problem we want to solve. This is usually a common problem that will occur in more than one application.</dd></dl>
<dl><dt>Forces</dt>
<dd>This section states the technological boundaries, that helps and guides the creation of the solution.</dd></dl>
<dl><dt>Solution</dt>
<dd>This section describes how to write the code to solve the above problem. This is the design part of the design pattern. It may contain class diagrams, sequence diagrams, and or whatever is needed to describe how to code the solution.</dd></dl>
<p>Design patterns can be considered as a standardization of commonly agreed best practices to solve specific design problems. One should understand them as a way to implement good design patterns within applications. Doing so will reduce the use of inefficient and obscure solutions. Using design patterns speeds up your design and helps to communicate it to other programmers.
</p>
<h2><span class="mw-headline" id="Creational_Patterns">Creational Patterns</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;veaction=edit&amp;section=T-1" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;action=edit&amp;section=T-1" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In software engineering, <b>creational design patterns</b> are design patterns that deal with object creation mechanisms, trying to create objects in a manner suitable to the situation. The basic form of object creation could result in design problems or added complexity to the design. Creational design patterns solve this problem by somehow controlling this object creation.
</p><p>In this section we assume that the reader has enough familiarity with functions, global variables, stack vs. heap, classes, pointers, and static member functions as introduced before.
</p><p>As we will see there are several creational design patterns, and all will deal with a specific implementation task, that will create a higher level of abstraction to the code base, we will now cover each one.
</p>
<h3><span class="mw-headline" id="Builder">Builder</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;veaction=edit&amp;section=T-2" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;action=edit&amp;section=T-2" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The Builder Creational Pattern is used to separate the construction of a complex object from its representation so that the same construction process can create different objects representations.
</p>
<dl><dt>Problem</dt>
<dd>We want to construct a complex object, however we do not want to have a complex constructor member or one that would need many arguments.</dd></dl>
<dl><dt>Solution</dt>
<dd>Define an intermediate object whose member functions define the desired object part by part before the object is available to the client.  Builder Pattern lets us defer the construction of the object until all the options for creation have been specified.</dd></dl>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="c1">// &quot;Product&quot;</span>
<span class="k">class</span> <span class="nc">Pizza</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">setDough</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">dough</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_dough</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dough</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">setSauce</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">sauce</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_sauce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sauce</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">setTopping</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">topping</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_topping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topping</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">open</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Pizza with &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_dough</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; dough, &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_sauce</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; sauce and &quot;</span><span class="w"></span>
<span class="w">			</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_topping</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; topping. Mmm.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">string</span><span class="w"> </span><span class="n">m_dough</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">string</span><span class="w"> </span><span class="n">m_sauce</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">string</span><span class="w"> </span><span class="n">m_topping</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// &quot;Abstract Builder&quot;</span>
<span class="k">class</span> <span class="nc">PizzaBuilder</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">PizzaBuilder</span><span class="p">()</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>

<span class="w">	</span><span class="n">Pizza</span><span class="o">*</span><span class="w"> </span><span class="nf">getPizza</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">m_pizza</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="nf">createNewPizzaProduct</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizza</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Pizza</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildDough</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildSauce</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildTopping</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="k">protected</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Pizza</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_pizza</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">//----------------------------------------------------------------</span>

<span class="k">class</span> <span class="nc">HawaiianPizzaBuilder</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">PizzaBuilder</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">HawaiianPizzaBuilder</span><span class="p">()</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildDough</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setDough</span><span class="p">(</span><span class="s">&quot;cross&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildSauce</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setSauce</span><span class="p">(</span><span class="s">&quot;mild&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildTopping</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setTopping</span><span class="p">(</span><span class="s">&quot;ham+pineapple&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">SpicyPizzaBuilder</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">PizzaBuilder</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">SpicyPizzaBuilder</span><span class="p">()</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildDough</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setDough</span><span class="p">(</span><span class="s">&quot;pan baked&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildSauce</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setSauce</span><span class="p">(</span><span class="s">&quot;hot&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildTopping</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setTopping</span><span class="p">(</span><span class="s">&quot;pepperoni+salami&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">//----------------------------------------------------------------</span>

<span class="k">class</span> <span class="nc">Cook</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">openPizza</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizzaBuilder</span><span class="o">-&gt;</span><span class="n">getPizza</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">open</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">makePizza</span><span class="p">(</span><span class="n">PizzaBuilder</span><span class="o">*</span><span class="w"> </span><span class="n">pb</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizzaBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pb</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizzaBuilder</span><span class="o">-&gt;</span><span class="n">createNewPizzaProduct</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizzaBuilder</span><span class="o">-&gt;</span><span class="n">buildDough</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizzaBuilder</span><span class="o">-&gt;</span><span class="n">buildSauce</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="n">m_pizzaBuilder</span><span class="o">-&gt;</span><span class="n">buildTopping</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">PizzaBuilder</span><span class="o">*</span><span class="w"> </span><span class="n">m_pizzaBuilder</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">Cook</span><span class="w"> </span><span class="n">cook</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">HawaiianPizzaBuilder</span><span class="w"> </span><span class="n">hawaiianPizzaBuilder</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">SpicyPizzaBuilder</span><span class="w">    </span><span class="n">spicyPizzaBuilder</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="n">cook</span><span class="p">.</span><span class="n">makePizza</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hawaiianPizzaBuilder</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">cook</span><span class="p">.</span><span class="n">openPizza</span><span class="p">();</span><span class="w"></span>

<span class="w">	</span><span class="n">cook</span><span class="p">.</span><span class="n">makePizza</span><span class="p">(</span><span class="o">&amp;</span><span class="n">spicyPizzaBuilder</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">cook</span><span class="p">.</span><span class="n">openPizza</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<p>You can also use the latest version c++17 standard
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span><span class="cp"></span>
<span class="k">class</span> <span class="nc">Pizza</span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">setDough</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">dough</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">m_dough</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dough</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">setSauce</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">sauce</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">m_sauce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sauce</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">setTopping</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">topping</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">m_topping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topping</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">open</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;The Pizza have &quot;</span><span class="o">&lt;&lt;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_dough</span><span class="o">&lt;&lt;</span><span class="s">&quot; dough, &quot;</span><span class="o">&lt;&lt;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_sauce</span><span class="o">&lt;&lt;</span><span class="s">&quot; sauce, &quot;</span><span class="o">&lt;&lt;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_topping</span><span class="o">&lt;&lt;</span><span class="s">&quot; topping.&quot;</span><span class="o">&lt;&lt;</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_dough</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_sauce</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_topping</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">PizzaBuilder</span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">PizzaBuilder</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">createNewPizza</span><span class="p">(){</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizza</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Pizza</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">Pizza</span><span class="o">*</span><span class="w"> </span><span class="nf">getPizza</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">m_pizza</span><span class="p">.</span><span class="n">release</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildDough</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildSauce</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildTopping</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="k">protected</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Pizza</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_pizza</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">HawaiianPizzaBuilder</span><span class="o">:</span><span class="k">public</span><span class="w"> </span><span class="n">PizzaBuilder</span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">HawaiianPizzaBuilder</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildDough</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setDough</span><span class="p">(</span><span class="s">&quot;Hawaiian dough&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildSauce</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setSauce</span><span class="p">(</span><span class="s">&quot;Hawaiian sauce&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildTopping</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setTopping</span><span class="p">(</span><span class="s">&quot;Hawaiian topping&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">SpicyPizzaBuilder</span><span class="o">:</span><span class="k">public</span><span class="w"> </span><span class="n">PizzaBuilder</span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">SpicyPizzaBuilder</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildDough</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setDough</span><span class="p">(</span><span class="s">&quot;Spicy dough&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildSauce</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setSauce</span><span class="p">(</span><span class="s">&quot;Spicy sauce&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildTopping</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizza</span><span class="o">-&gt;</span><span class="n">setTopping</span><span class="p">(</span><span class="s">&quot;Spicy topping&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Cook</span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">openPizza</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizzaBuilder</span><span class="o">-&gt;</span><span class="n">getPizza</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">open</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">createPizza</span><span class="p">(</span><span class="n">PizzaBuilder</span><span class="o">*</span><span class="w"> </span><span class="n">pizzaBuilder</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizzaBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pizzaBuilder</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizzaBuilder</span><span class="o">-&gt;</span><span class="n">createNewPizza</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizzaBuilder</span><span class="o">-&gt;</span><span class="n">buildDough</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizzaBuilder</span><span class="o">-&gt;</span><span class="n">buildSauce</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pizzaBuilder</span><span class="o">-&gt;</span><span class="n">buildTopping</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">PizzaBuilder</span><span class="o">*</span><span class="w"> </span><span class="n">m_pizzaBuilder</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(){</span><span class="w"></span>
<span class="w">    </span><span class="n">Cook</span><span class="w"> </span><span class="n">cook</span><span class="p">{};</span><span class="w"></span>
<span class="w">    </span><span class="n">HawaiianPizzaBuilder</span><span class="w"> </span><span class="n">hawaiianPizzaBuilder</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cook</span><span class="p">.</span><span class="n">createPizza</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hawaiianPizzaBuilder</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">cook</span><span class="p">.</span><span class="n">openPizza</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">SpicyPizzaBuilder</span><span class="w"> </span><span class="n">spicyPizzaBuilder</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cook</span><span class="p">.</span><span class="n">createPizza</span><span class="p">(</span><span class="o">&amp;</span><span class="n">spicyPizzaBuilder</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">cook</span><span class="p">.</span><span class="n">openPizza</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="c1">//console output</span>
<span class="c1">//The Pizza have Hawaiian dough dough, Hawaiian sauce sauce, Hawaiian topping topping.</span>
<span class="c1">//The Pizza have Spicy dough dough, Spicy sauce sauce, Spicy topping topping.</span>
</pre></div>
<h3><span class="mw-headline" id="Factory">Factory</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;veaction=edit&amp;section=T-3" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;action=edit&amp;section=T-3" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><b>Definition</b>: A utility class that creates an instance of a class from a family of derived classes
</p>
<h3><span class="mw-headline" id="Abstract_Factory">Abstract Factory</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;veaction=edit&amp;section=T-4" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;action=edit&amp;section=T-4" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><b>Definition</b>: A utility class that creates an instance of several families of classes. It can also return
a factory for a certain group.
</p><p>The Factory Design Pattern is useful in a situation that requires the creation of many different types of objects, all derived from a common base type. The Factory Method defines a method for creating the objects, which subclasses can then override to specify the derived type that will be created. Thus, at run time, the Factory Method can be passed a description of a desired object (e.g., a string read from user input) and return a base class pointer to a new instance of that object. The pattern works best when a well-designed interface is used for the base class, so there is no need to cast the returned object.
</p>
<dl><dt>Problem</dt>
<dd>We want to decide at run time what object is to be created based on some configuration or application parameter. When we write the code, we do not know what class should be instantiated.</dd></dl>
<dl><dt>Solution</dt>
<dd>Define an interface for creating an object, but let subclasses decide which class to instantiate. Factory Method lets a class defer instantiation to subclasses.</dd></dl>
<p>In the following example, a factory method is used to create laptop or desktop computer objects at run time.
</p><p>Let's start by defining <code>Computer</code>, which is an abstract base class (interface) and its derived classes: <code>Laptop</code> and <code>Desktop</code>.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="w"> </span><span class="k">class</span> <span class="nc">Computer</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">Run</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">Stop</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span>
<span class="w">     </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Computer</span><span class="p">()</span><span class="w"> </span><span class="p">{};</span><span class="w"> </span><span class="cm">/* without this, you do not call Laptop or Desktop destructor in this example! */</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w"> </span><span class="k">class</span> <span class="nc">Laptop</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Computer</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="kt">void</span><span class="w"> </span><span class="n">Run</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="n">mHibernating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;};</span><span class="w"> </span>
<span class="w">     </span><span class="kt">void</span><span class="w"> </span><span class="nf">Stop</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="n">mHibernating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;};</span><span class="w"> </span>
<span class="w">     </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Laptop</span><span class="p">()</span><span class="w"> </span><span class="p">{};</span><span class="w"> </span><span class="cm">/* because we have virtual functions, we need virtual destructor */</span><span class="w"></span>
<span class="w"> </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="kt">bool</span><span class="w"> </span><span class="n">mHibernating</span><span class="p">;</span><span class="w"> </span><span class="c1">// Whether or not the machine is hibernating</span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w"> </span><span class="k">class</span> <span class="nc">Desktop</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Computer</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="kt">void</span><span class="w"> </span><span class="n">Run</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="n">mOn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;};</span><span class="w"> </span>
<span class="w">     </span><span class="kt">void</span><span class="w"> </span><span class="nf">Stop</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="n">mOn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;};</span><span class="w"> </span>
<span class="w">     </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Desktop</span><span class="p">()</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>
<span class="w"> </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="kt">bool</span><span class="w"> </span><span class="n">mOn</span><span class="p">;</span><span class="w"> </span><span class="c1">// Whether or not the machine has been turned on</span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>
</pre></div>
<p>The actual <code>ComputerFactory</code> class returns a <code>Computer</code>, given a real world description of the object.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="w"> </span><span class="k">class</span> <span class="nc">ComputerFactory</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="k">static</span><span class="w"> </span><span class="n">Computer</span><span class="w"> </span><span class="o">*</span><span class="n">NewComputer</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">description</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">description</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;laptop&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Laptop</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">description</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;desktop&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Desktop</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="k">return</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>
</pre></div>
<p>Let's analyze the benefits of this design. First, there is a compilation benefit. If we move the interface <code>Computer</code> into a separate header file with the factory, we can then move the implementation of the <code>NewComputer()</code> function into a separate implementation file. Now the implementation file for <code>NewComputer()</code> is the only one that requires knowledge of the derived classes. Thus, if a change is made to any derived class of <code>Computer</code>, or a new <code>Computer</code> subtype is added, the implementation file for <code>NewComputer()</code> is the only file that needs to be recompiled. Everyone who uses the factory will only care about the interface, which should remain consistent throughout the life of the application.
</p><p>Also, if there is a need to add a class, and the user is requesting objects through a user interface, no code calling the factory may be required to change to support the additional computer type. The code using the factory would simply pass on the new string to the factory, and allow the factory to handle the new types entirely.
</p><p>Imagine programming a video game, where you would like to add new types of enemies in the future, each of which has different AI functions and can update differently. By using a factory method, the controller of the program can call to the factory to create the enemies, without any dependency or knowledge of the actual types of enemies. Now, future developers can create new enemies, with new AI controls and new drawing member functions, add it to the factory, and create a level which calls the factory, asking for the enemies by name. Combine this method with an <a href="/wiki/XML" class="mw-redirect" title="XML">XML</a> description of levels, and developers could create new levels without having to recompile their program. All this, thanks to the separation of creation of objects from the usage of objects.
</p><p>Another example:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdexcept&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Pizza</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">getPrice</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Pizza</span><span class="p">()</span><span class="w"> </span><span class="p">{};</span><span class="w">  </span><span class="cm">/* without this, no destructor for derived Pizza&#39;s will be called. */</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">HamAndMushroomPizza</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Pizza</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">getPrice</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">850</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">HamAndMushroomPizza</span><span class="p">()</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">DeluxePizza</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Pizza</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">getPrice</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">1050</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">DeluxePizza</span><span class="p">()</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">HawaiianPizza</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Pizza</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">getPrice</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">1150</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">HawaiianPizza</span><span class="p">()</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">PizzaFactory</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">enum</span> <span class="nc">PizzaType</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">HamMushroom</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="n">Deluxe</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="n">Hawaiian</span><span class="w"></span>
<span class="w">	</span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Pizza</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createPizza</span><span class="p">(</span><span class="n">PizzaType</span><span class="w"> </span><span class="n">pizzaType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">pizzaType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="nl">HamMushroom</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">HamAndMushroomPizza</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="nl">Deluxe</span><span class="p">:</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">DeluxePizza</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="nl">Hawaiian</span><span class="p">:</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">HawaiianPizza</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="w">		</span><span class="k">throw</span><span class="w"> </span><span class="s">&quot;invalid pizza type.&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/*</span>
<span class="cm">* Create all available pizzas and print their prices</span>
<span class="cm">*/</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="nf">pizza_information</span><span class="p">(</span><span class="n">PizzaFactory</span><span class="o">::</span><span class="n">PizzaType</span><span class="w"> </span><span class="n">pizzatype</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Pizza</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pizza</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PizzaFactory</span><span class="o">::</span><span class="n">createPizza</span><span class="p">(</span><span class="n">pizzatype</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Price of &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">pizzatype</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">pizza</span><span class="o">-&gt;</span><span class="n">getPrice</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">pizza_information</span><span class="p">(</span><span class="n">PizzaFactory</span><span class="o">::</span><span class="n">HamMushroom</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">pizza_information</span><span class="p">(</span><span class="n">PizzaFactory</span><span class="o">::</span><span class="n">Deluxe</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">pizza_information</span><span class="p">(</span><span class="n">PizzaFactory</span><span class="o">::</span><span class="n">Hawaiian</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Prototype">Prototype</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;veaction=edit&amp;section=T-5" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;action=edit&amp;section=T-5" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>A prototype pattern is used in software development when the type of objects to create is determined by a prototypical instance, which is cloned to produce new objects. This pattern is used, for example, when the inherent cost of creating a new object in the standard way (e.g., using the <code>new</code> keyword) is prohibitively expensive for a given application.
</p><p><b>Implementation</b>: Declare an abstract base class that specifies a pure virtual <code>clone()</code> method. Any class that needs a "polymorphic constructor" capability derives itself from the abstract base class, and implements the <code>clone()</code> operation.
</p><p>Here the client code first invokes the factory method. This factory method, depending on the parameter, finds out the concrete class.  On this concrete class, the <code>clone()</code> method is called and the object is returned by the factory method.
</p>
<ul><li>This is a sample implementation of Prototype method. We have the detailed description of all the components here.
<ul><li><code>Record</code> class, which is a pure virtual class that has a pure virtual method <code>clone()</code>.</li>
<li><code>CarRecord</code>, <code>BikeRecord</code> and <code>PersonRecord</code> as concrete implementation of a <code>Record</code> class.</li>
<li>An <a href="/wiki/C%2B%2B_Programming/Programming_Languages/C%2B%2B/Code/Keywords/enum" title="C++ Programming/Programming Languages/C++/Code/Keywords/enum"><tt style="color:DodgerBlue; text-decoration:none; font-weight:bold;">enum</tt></a> RecordType as one to one mapping of each concrete implementation of <code>Record</code> class.</li>
<li><code>RecordFactory</code> class that has a <code>Factory</code> method <code>CreateRecord(â€¦)</code>. This method requires an <a href="/wiki/C%2B%2B_Programming/Programming_Languages/C%2B%2B/Code/Keywords/enum" title="C++ Programming/Programming Languages/C++/Code/Keywords/enum"><tt style="color:DodgerBlue; text-decoration:none; font-weight:bold;">enum</tt></a> RecordType as parameter and depending on this parameter it returns the concrete implementation of <code>Record</code> class.</li></ul></li></ul>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cm">/** Implementation of Prototype Method **/</span><span class="w"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unordered_map&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="cm">/** Record is the base Prototype */</span><span class="w"></span>
<span class="k">class</span> <span class="nc">Record</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Record</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">print</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Record</span><span class="o">&gt;</span><span class="w"> </span><span class="n">clone</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/** CarRecord is a Concrete Prototype */</span><span class="w"></span>
<span class="k">class</span> <span class="nc">CarRecord</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Record</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">string</span><span class="w"> </span><span class="n">m_carName</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_ID</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">CarRecord</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">carName</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">m_carName</span><span class="p">(</span><span class="n">carName</span><span class="p">),</span><span class="w"> </span><span class="n">m_ID</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">print</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Car Record&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"></span>
<span class="w">		     </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Name &#160;: &quot;</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_carName</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"></span>
<span class="w">		     </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Number: &quot;</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_ID</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Record</span><span class="o">&gt;</span><span class="w"> </span><span class="n">clone</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">CarRecord</span><span class="o">&gt;</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/** BikeRecord is the Concrete Prototype */</span><span class="w"></span>
<span class="k">class</span> <span class="nc">BikeRecord</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Record</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">string</span><span class="w"> </span><span class="n">m_bikeName</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_ID</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">BikeRecord</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">bikeName</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">m_bikeName</span><span class="p">(</span><span class="n">bikeName</span><span class="p">),</span><span class="w"> </span><span class="n">m_ID</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">print</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Bike Record&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"></span>
<span class="w">		     </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Name &#160;: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_bikeName</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"></span>
<span class="w">		     </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Number: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_ID</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Record</span><span class="o">&gt;</span><span class="w"> </span><span class="n">clone</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">BikeRecord</span><span class="o">&gt;</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/** PersonRecord is the Concrete Prototype */</span><span class="w"></span>
<span class="k">class</span> <span class="nc">PersonRecord</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Record</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">string</span><span class="w"> </span><span class="n">m_personName</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_age</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">PersonRecord</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">personName</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">m_personName</span><span class="p">(</span><span class="n">personName</span><span class="p">),</span><span class="w"> </span><span class="n">m_age</span><span class="p">(</span><span class="n">age</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">print</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Person Record&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"></span>
<span class="w">			</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Name&#160;: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_personName</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"></span>
<span class="w">			</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Age &#160;: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m_age</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Record</span><span class="o">&gt;</span><span class="w"> </span><span class="n">clone</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">PersonRecord</span><span class="o">&gt;</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/** Opaque record type, avoids exposing concrete implementations */</span><span class="w"></span>
<span class="k">enum</span> <span class="nc">RecordType</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">CAR</span><span class="p">,</span><span class="w"></span>
<span class="w">	</span><span class="n">BIKE</span><span class="p">,</span><span class="w"></span>
<span class="w">	</span><span class="n">PERSON</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/** RecordFactory is the client */</span><span class="w"></span>
<span class="k">class</span> <span class="nc">RecordFactory</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">RecordType</span><span class="p">,</span><span class="w"> </span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Record</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">hash</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_records</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">RecordFactory</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_records</span><span class="p">[</span><span class="n">CAR</span><span class="p">]</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">CarRecord</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;Ferrari&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5050</span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="n">m_records</span><span class="p">[</span><span class="n">BIKE</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">BikeRecord</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;Yamaha&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2525</span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="n">m_records</span><span class="p">[</span><span class="n">PERSON</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">PersonRecord</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;Tom&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Record</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createRecord</span><span class="p">(</span><span class="n">RecordType</span><span class="w"> </span><span class="n">recordType</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">m_records</span><span class="p">[</span><span class="n">recordType</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">clone</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">RecordFactory</span><span class="w"> </span><span class="n">recordFactory</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">record</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recordFactory</span><span class="p">.</span><span class="n">createRecord</span><span class="p">(</span><span class="n">CAR</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">record</span><span class="o">-&gt;</span><span class="n">print</span><span class="p">();</span><span class="w"></span>

<span class="w">	</span><span class="n">record</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recordFactory</span><span class="p">.</span><span class="n">createRecord</span><span class="p">(</span><span class="n">BIKE</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">record</span><span class="o">-&gt;</span><span class="n">print</span><span class="p">();</span><span class="w"></span>

<span class="w">	</span><span class="n">record</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recordFactory</span><span class="p">.</span><span class="n">createRecord</span><span class="p">(</span><span class="n">PERSON</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">record</span><span class="o">-&gt;</span><span class="n">print</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<p>Another example:
</p><p>To implement the pattern, declare an abstract base class that specifies a pure virtual <code>clone()</code> member function. Any class that needs a "polymorphic constructor" capability derives itself from the abstract base class, and implements the <code>clone()</code> operation.
</p><p>The client, instead of writing code that invokes the <code>new</code> operator on a hard-wired class name, calls the <code>clone()</code> member function on the prototype, calls a factory member function with a parameter designating the particular concrete derived class desired, or invokes the <code>clone()</code> member function through some mechanism provided by another design pattern.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="w"> </span><span class="k">class</span> <span class="nc">CPrototypeMonster</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">protected</span><span class="o">:</span><span class="w">            </span>
<span class="w">     </span><span class="n">CString</span><span class="w">           </span><span class="n">_name</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="n">CPrototypeMonster</span><span class="p">();</span><span class="w"></span>
<span class="w">     </span><span class="n">CPrototypeMonster</span><span class="p">(</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CPrototypeMonster</span><span class="o">&amp;</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">CPrototypeMonster</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span>
<span class="w">     </span><span class="k">virtual</span><span class="w"> </span><span class="n">CPrototypeMonster</span><span class="o">*</span><span class="w">    </span><span class="nf">Clone</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// This forces every derived class to provide an override for this function.</span>
<span class="w">     </span><span class="kt">void</span><span class="w">        </span><span class="nf">Name</span><span class="p">(</span><span class="w"> </span><span class="n">CString</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="n">CString</span><span class="w">    </span><span class="nf">Name</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w"> </span><span class="k">class</span> <span class="nc">CGreenMonster</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">CPrototypeMonster</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">protected</span><span class="o">:</span><span class="w"> </span>
<span class="w">     </span><span class="kt">int</span><span class="w">         </span><span class="n">_numberOfArms</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="kt">double</span><span class="w">      </span><span class="n">_slimeAvailable</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="n">CGreenMonster</span><span class="p">();</span><span class="w"></span>
<span class="w">     </span><span class="n">CGreenMonster</span><span class="p">(</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CGreenMonster</span><span class="o">&amp;</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="o">~</span><span class="n">CGreenMonster</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span>
<span class="w">     </span><span class="k">virtual</span><span class="w"> </span><span class="n">CPrototypeMonster</span><span class="o">*</span><span class="w">    </span><span class="nf">Clone</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="kt">void</span><span class="w">  </span><span class="nf">NumberOfArms</span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">numberOfArms</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="kt">void</span><span class="w">  </span><span class="nf">SlimeAvailable</span><span class="p">(</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">slimeAvailable</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w"> </span>
<span class="w">     </span><span class="kt">int</span><span class="w">         </span><span class="nf">NumberOfArms</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="kt">double</span><span class="w">      </span><span class="nf">SlimeAvailable</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w"> </span><span class="k">class</span> <span class="nc">CPurpleMonster</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">CPrototypeMonster</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">protected</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="kt">int</span><span class="w">         </span><span class="n">_intensityOfBadBreath</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="kt">double</span><span class="w">      </span><span class="n">_lengthOfWhiplikeAntenna</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="n">CPurpleMonster</span><span class="p">();</span><span class="w"></span>
<span class="w">     </span><span class="n">CPurpleMonster</span><span class="p">(</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CPurpleMonster</span><span class="o">&amp;</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="o">~</span><span class="n">CPurpleMonster</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span>
<span class="w">     </span><span class="k">virtual</span><span class="w"> </span><span class="n">CPrototypeMonster</span><span class="o">*</span><span class="w">    </span><span class="nf">Clone</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span>
<span class="w">     </span><span class="kt">void</span><span class="w">  </span><span class="nf">IntensityOfBadBreath</span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">intensityOfBadBreath</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="kt">void</span><span class="w">  </span><span class="nf">LengthOfWhiplikeAntenna</span><span class="p">(</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lengthOfWhiplikeAntenna</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w"> </span>
<span class="w">     </span><span class="kt">int</span><span class="w">       </span><span class="nf">IntensityOfBadBreath</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="kt">double</span><span class="w">    </span><span class="nf">LengthOfWhiplikeAntenna</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w"> </span><span class="k">class</span> <span class="nc">CBellyMonster</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">CPrototypeMonster</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">protected</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="kt">double</span><span class="w">      </span><span class="n">_roomAvailableInBelly</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="n">CBellyMonster</span><span class="p">();</span><span class="w"></span>
<span class="w">     </span><span class="n">CBellyMonster</span><span class="p">(</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CBellyMonster</span><span class="o">&amp;</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="o">~</span><span class="n">CBellyMonster</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span>
<span class="w">     </span><span class="k">virtual</span><span class="w"> </span><span class="n">CPrototypeMonster</span><span class="o">*</span><span class="w">    </span><span class="nf">Clone</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span>
<span class="w">     </span><span class="kt">void</span><span class="w">       </span><span class="nf">RoomAvailableInBelly</span><span class="p">(</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">roomAvailableInBelly</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="kt">double</span><span class="w">     </span><span class="nf">RoomAvailableInBelly</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w"> </span><span class="n">CPrototypeMonster</span><span class="o">*</span><span class="w"> </span><span class="nf">CGreenMonster::Clone</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CGreenMonster</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="n">CPrototypeMonster</span><span class="o">*</span><span class="w"> </span><span class="nf">CPurpleMonster::Clone</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CPurpleMonster</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="n">CPrototypeMonster</span><span class="o">*</span><span class="w"> </span><span class="nf">CBellyMonster::Clone</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CBellyMonster</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
<p>A client of one of the concrete monster classes only needs a reference (pointer) to a 
<code>CPrototypeMonster</code> class object to be able to call the â€˜Cloneâ€™ function and create copies of that object. The function below demonstrates this concept:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">DoSomeStuffWithAMonster</span><span class="p">(</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CPrototypeMonster</span><span class="o">*</span><span class="w"> </span><span class="n">originalMonster</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="n">CPrototypeMonster</span><span class="o">*</span><span class="w"> </span><span class="n">newMonster</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">originalMonster</span><span class="o">-&gt;</span><span class="n">Clone</span><span class="p">();</span><span class="w"></span>
<span class="w">     </span><span class="n">ASSERT</span><span class="p">(</span><span class="w"> </span><span class="n">newMonster</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w"> </span>
<span class="w">     </span><span class="n">newMonster</span><span class="o">-&gt;</span><span class="n">Name</span><span class="p">(</span><span class="s">&quot;MyOwnMonster&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="c1">// Add code doing all sorts of cool stuff with the monster.</span>
<span class="w">     </span><span class="k">delete</span><span class="w"> </span><span class="n">newMonster</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
<p>Now originalMonster can be passed as a pointer to CGreenMonster, CPurpleMonster or CBellyMonster.
</p>
<h3><span class="mw-headline" id="Singleton">Singleton</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;veaction=edit&amp;section=T-6" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Creational_Patterns&amp;action=edit&amp;section=T-6" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The <b>Singleton pattern</b> ensures that a class has only one instance and provides a global point of access to that instance. It is named after the singleton set, which is defined to be a set containing one element. This is useful when exactly one object is needed to coordinate actions across the system.
</p><p><b>Check list</b> 
</p>
<ul><li>Define a private static attribute in the "single instance" class.</li>
<li>Define a public static accessor function in the class.</li>
<li>Do "lazy initialization" (creation on first use) in the accessor function.</li>
<li>Define all constructors to be protected or private.</li>
<li>Clients may only use the accessor function to manipulate the Singleton.</li></ul>
<p>Let's take a look at how a Singleton differs from other variable types.
</p><p>Like a global variable, the Singleton exists outside of the scope of any functions. Traditional implementation uses a static member function of the Singleton class, which will create a single instance of the Singleton class on the first call, and forever return that instance. The following code example illustrates the elements of a C++ singleton class, that simply stores a single string.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="w"> </span><span class="k">class</span> <span class="nc">StringSingleton</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="c1">// Some accessor functions for the class, itself</span>
<span class="w">     </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">GetString</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span>
<span class="w">     </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">mString</span><span class="p">;}</span><span class="w"></span>
<span class="w">     </span><span class="kt">void</span><span class="w"> </span><span class="n">SetString</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">newStr</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">{</span><span class="n">mString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newStr</span><span class="p">;}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">     </span><span class="c1">// The magic function, which allows access to the class from anywhere</span>
<span class="w">     </span><span class="c1">// To get the value of the instance of the class, call:</span>
<span class="w">     </span><span class="c1">//     StringSingleton::Instance().GetString();</span>
<span class="w">     </span><span class="k">static</span><span class="w"> </span><span class="n">StringSingleton</span><span class="w"> </span><span class="o">&amp;</span><span class="n">Instance</span><span class="p">()</span><span class="w"></span>
<span class="w">     </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="c1">// This line only runs once, thus creating the only instance in existence</span>
<span class="w">         </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">StringSingleton</span><span class="o">&gt;</span><span class="w"> </span><span class="n">instance</span><span class="p">(</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringSingleton</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">         </span><span class="c1">// dereferencing the variable here, saves the caller from having to use </span>
<span class="w">         </span><span class="c1">// the arrow operator, and removes temptation to try and delete the </span>
<span class="w">         </span><span class="c1">// returned instance.</span>
<span class="w">         </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="n">instance</span><span class="p">;</span><span class="w"> </span><span class="c1">// always returns the same instance</span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span><span class="k">private</span><span class="o">:</span><span class="w"> </span>
<span class="w">     </span><span class="c1">// We need to make some given functions private to finish the definition of the singleton</span>
<span class="w">     </span><span class="n">StringSingleton</span><span class="p">(){}</span><span class="w"> </span><span class="c1">// default constructor available only to members or friends of this class</span>
<span class="w"> </span>
<span class="w">     </span><span class="c1">// Note that the next two functions are not given bodies, thus any attempt </span>
<span class="w">     </span><span class="c1">// to call them implicitly will return as compiler errors. This prevents </span>
<span class="w">     </span><span class="c1">// accidental copying of the only instance of the class.</span>
<span class="w">     </span><span class="n">StringSingleton</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">StringSingleton</span><span class="w"> </span><span class="o">&amp;</span><span class="n">old</span><span class="p">);</span><span class="w"> </span><span class="c1">// disallow copy constructor</span>
<span class="w">     </span><span class="k">const</span><span class="w"> </span><span class="n">StringSingleton</span><span class="w"> </span><span class="o">&amp;</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">StringSingleton</span><span class="w"> </span><span class="o">&amp;</span><span class="n">old</span><span class="p">);</span><span class="w"> </span><span class="c1">//disallow assignment operator</span>
<span class="w"> </span>
<span class="w">     </span><span class="c1">// Note that although this should be allowed, </span>
<span class="w">     </span><span class="c1">// some compilers may not implement private destructors</span>
<span class="w">     </span><span class="c1">// This prevents others from deleting our one single instance, which was otherwise created on the heap</span>
<span class="w">     </span><span class="o">~</span><span class="n">StringSingleton</span><span class="p">(){}</span><span class="w"> </span>
<span class="w"> </span><span class="k">private</span><span class="o">:</span><span class="w"> </span><span class="c1">// private data for an instance of this class</span>
<span class="w">     </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">mString</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>
</pre></div>
<p>Variations of Singletons:
</p><p><br />
</p>
<table style="background: #ffd; border: 1px solid #aaaaaa; padding: 3px; margin: 5px auto; width: 60%" class="notice noprint notice-todo">
<tbody><tr>
<td style="width: 58px;"><div class="floatleft"><img alt="Clipboard" src="//upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/45px-Clipboard.svg.png" decoding="async" width="45" height="45" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/68px-Clipboard.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/90px-Clipboard.svg.png 2x" data-file-width="48" data-file-height="48" /></div>
</td>
<td>
<p><b>To do:</b><br />Discussion of Meyers Singleton and any other variations.
</p>
</td></tr></tbody></table>
<p><br />
</p><p>Applications of Singleton Class:
</p><p>One common use of the singleton design pattern is for application configurations. Configurations may need to be accessible globally, and future expansions to the application configurations may be needed. The subset C's closest alternative would be to create a single global <i><code>struct</code></i>. This had the lack of clarity as to where this object was instantiated, as well as not guaranteeing the existence of the object.
</p><p>Take, for example, the situation of another developer using your singleton inside the constructor of their object. Then, yet another developer decides to create an instance of the second class in the global scope. If you had simply used a global variable, the order of linking would then matter. Since your global will be accessed, possibly before main begins executing, there is no definition as to whether the global is initialized, or the constructor of the second class is called first. This behavior can then change with slight modifications to other areas of code, which would change order of global code execution. Such an error can be very hard to debug. But, with use of the singleton, the first time the object is accessed, the object will also be created. You now have an object which will always exist, in relation to being used, and will never exist if never used.
</p><p>A second common use of this class is in updating old code to work in a new architecture. Since developers may have used globals liberally, moving them into a single class and making it a singleton, can be an intermediary step to bring the program inline to stronger object oriented structure.
</p><p>Another example:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="cm">/* Place holder for thread synchronization mutex */</span><span class="w"></span>
<span class="k">class</span> <span class="nc">Mutex</span><span class="w"></span>
<span class="p">{</span><span class="w">   </span><span class="cm">/* placeholder for code to create, use, and free a mutex */</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/* Place holder for thread synchronization lock */</span><span class="w"></span>
<span class="k">class</span> <span class="nc">Lock</span><span class="w"></span>
<span class="p">{</span><span class="w">   </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">Lock</span><span class="p">(</span><span class="n">Mutex</span><span class="o">&amp;</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">mutex</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* placeholder code to acquire the mutex */</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="o">~</span><span class="n">Lock</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* placeholder code to release the mutex */</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">Mutex</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">mutex</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Singleton</span><span class="w"></span>
<span class="p">{</span><span class="w">   </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="n">Singleton</span><span class="o">*</span><span class="w"> </span><span class="n">GetInstance</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="o">~</span><span class="n">Singleton</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;In Destructor&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">Singleton</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">_a</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">_a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;In Constructor&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="n">Mutex</span><span class="w"> </span><span class="n">mutex</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Not defined, to prevent copying</span>
<span class="w">        </span><span class="n">Singleton</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Singleton</span><span class="o">&amp;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Singleton</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Singleton</span><span class="o">&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="n">Mutex</span><span class="w"> </span><span class="n">Singleton</span><span class="o">::</span><span class="n">mutex</span><span class="p">;</span><span class="w"></span>

<span class="n">Singleton</span><span class="o">*</span><span class="w"> </span><span class="nf">Singleton::GetInstance</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Lock</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">mutex</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Get Instance&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Initialized during first access</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="n">inst</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">inst</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Singleton</span><span class="o">*</span><span class="w"> </span><span class="n">singleton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Singleton</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;The value of the singleton: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">singleton</span><span class="o">-&gt;</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<table class="notice notice-note noprint" style="background: #f2fff2; border: solid 1px #bfffbf; padding: 0.5em; width: 95%; margin: auto; vertical-align: top; -moz-border-radius:10px;">
<tbody><tr>
<td>
<p><b>Note:</b><br />
In the above example, the first call to <code>Singleton::GetInstance</code> will initialize the singleton instance. This example is for illustrative purposes only; for anything but a trivial example program, this code contains errors.
</p>
</td></tr></tbody></table>
<h2><span class="mw-headline" id="Structural_Patterns">Structural Patterns</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;veaction=edit&amp;section=T-1" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;action=edit&amp;section=T-1" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Adapter">Adapter</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;veaction=edit&amp;section=T-2" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;action=edit&amp;section=T-2" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Convert the interface of a class into another interface that clients expect. <b>Adapter</b> lets classes work together that couldn't otherwise because of incompatible interfaces.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="linenos" data-line="2"></span>
<span class="linenos" data-line="3"></span><span class="k">class</span> <span class="nc">Dog</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// Abstract Target</span>
<span class="linenos" data-line="4"></span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="linenos" data-line="5"></span><span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Dog</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span><span class="w"></span>
<span class="linenos" data-line="6"></span><span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">performsConversion</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="linenos" data-line="7"></span><span class="p">};</span><span class="w"></span>
<span class="linenos" data-line="8"></span>
<span class="linenos" data-line="9"></span><span class="k">class</span> <span class="nc">DogFemale</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Dog</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// Concrete Target</span>
<span class="linenos" data-line="10"></span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="linenos" data-line="11"></span><span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">performsConversion</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Dog female performs conversion.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="linenos" data-line="12"></span><span class="p">};</span><span class="w"></span>
<span class="linenos" data-line="13"></span>
<span class="linenos" data-line="14"></span><span class="k">class</span> <span class="nc">Cat</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// Abstract Adaptee</span>
<span class="linenos" data-line="15"></span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="linenos" data-line="16"></span><span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Cat</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span><span class="w"></span>
<span class="linenos" data-line="17"></span><span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">performsConversion</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="linenos" data-line="18"></span><span class="p">};</span><span class="w"></span>
<span class="linenos" data-line="19"></span>
<span class="linenos" data-line="20"></span><span class="k">class</span> <span class="nc">CatFemale</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Cat</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// Concrete Adaptee</span>
<span class="linenos" data-line="21"></span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="linenos" data-line="22"></span><span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">performsConversion</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Cat female performs conversion.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="linenos" data-line="23"></span><span class="p">};</span><span class="w"></span>
<span class="linenos" data-line="24"></span>
<span class="linenos" data-line="25"></span><span class="k">class</span> <span class="nc">DogNature</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos" data-line="26"></span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="linenos" data-line="27"></span><span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">carryOutNature</span><span class="p">(</span><span class="n">Dog</span><span class="o">*</span><span class="w"> </span><span class="n">dog</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos" data-line="28"></span><span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;On with the Dog nature!&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos" data-line="29"></span><span class="w">		</span><span class="n">dog</span><span class="o">-&gt;</span><span class="n">performsConversion</span><span class="p">();</span><span class="w"></span>
<span class="linenos" data-line="30"></span><span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="linenos" data-line="31"></span><span class="p">};</span><span class="w"></span>
<span class="linenos" data-line="32"></span>
<span class="linenos" data-line="33"></span><span class="k">class</span> <span class="nc">ConversionAdapter</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Dog</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// Adapter</span>
<span class="linenos" data-line="34"></span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="linenos" data-line="35"></span><span class="w">	</span><span class="n">Cat</span><span class="o">*</span><span class="w"> </span><span class="n">cat</span><span class="p">;</span><span class="w"></span>
<span class="linenos" data-line="36"></span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="linenos" data-line="37"></span><span class="w">	</span><span class="n">ConversionAdapter</span><span class="p">(</span><span class="n">Cat</span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">cat</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="linenos" data-line="38"></span><span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">performsConversion</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cat</span><span class="o">-&gt;</span><span class="n">performsConversion</span><span class="p">();</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="linenos" data-line="39"></span><span class="p">};</span><span class="w"></span>
<span class="linenos" data-line="40"></span>
<span class="linenos" data-line="41"></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// Client code</span>
<span class="linenos" data-line="42"></span><span class="w">	</span><span class="n">DogFemale</span><span class="o">*</span><span class="w"> </span><span class="n">dogFemale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DogFemale</span><span class="p">;</span><span class="w"></span>
<span class="linenos" data-line="43"></span><span class="w">	</span><span class="n">CatFemale</span><span class="o">*</span><span class="w"> </span><span class="n">catFemale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CatFemale</span><span class="p">;</span><span class="w"></span>
<span class="linenos" data-line="44"></span><span class="w">	</span><span class="n">DogNature</span><span class="w"> </span><span class="n">dogNature</span><span class="p">;</span><span class="w"></span>
<span class="linenos" data-line="45"></span><span class="w">	</span><span class="c1">//	dogNature.carryOutNature (catFemale);  // Will not compile of course since the parameter must be of type Dog*.</span>
<span class="linenos" data-line="46"></span><span class="w">	</span><span class="n">ConversionAdapter</span><span class="o">*</span><span class="w"> </span><span class="n">adaptedCat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConversionAdapter</span><span class="p">(</span><span class="n">catFemale</span><span class="p">);</span><span class="w">  </span><span class="c1">// catFemale has adapted to become a Dog!</span>
<span class="linenos" data-line="47"></span>
<span class="linenos" data-line="48"></span><span class="w">	</span><span class="n">dogNature</span><span class="p">.</span><span class="n">carryOutNature</span><span class="p">(</span><span class="n">dogFemale</span><span class="p">);</span><span class="w"></span>
<span class="linenos" data-line="49"></span><span class="w">	</span><span class="n">dogNature</span><span class="p">.</span><span class="n">carryOutNature</span><span class="p">(</span><span class="n">adaptedCat</span><span class="p">);</span><span class="w">  </span><span class="c1">// So now catFemale, in the form of adaptedCat, participates in the dogNature!</span>
<span class="linenos" data-line="50"></span><span class="w">				</span><span class="c1">// Note that catFemale is carrying out her own type of nature in dogNature though.</span>
<span class="linenos" data-line="51"></span>
<span class="linenos" data-line="52"></span><span class="w">	</span><span class="k">delete</span><span class="w"> </span><span class="n">adaptedCat</span><span class="p">;</span><span class="w">  </span><span class="c1">// adaptedCat is not needed anymore</span>
<span class="linenos" data-line="53"></span><span class="w">	</span><span class="k">delete</span><span class="w"> </span><span class="n">catFemale</span><span class="p">;</span><span class="w"> </span><span class="c1">// catFemale is not needed anymore</span>
<span class="linenos" data-line="54"></span><span class="w">	</span><span class="k">delete</span><span class="w"> </span><span class="n">dogFemale</span><span class="p">;</span><span class="w"> </span><span class="c1">// dogFemale is not needed anymore, too</span>
<span class="linenos" data-line="55"></span><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="linenos" data-line="56"></span><span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Bridge">Bridge</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;veaction=edit&amp;section=T-3" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;action=edit&amp;section=T-3" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The Bridge Pattern is used to separate out the interface from its implementation. Doing this gives the flexibility so that both can vary independently.
</p><p>The following example will output:
</p>
<pre>API1.circle at 1:2 7.5
API2.circle at 5:7 27.5
</pre>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="cm">/* Implementor*/</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DrawingAPI</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">   </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">drawCircle</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">DrawingAPI</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/* Concrete ImplementorA*/</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DrawingAPI1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">DrawingAPI</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="n">drawCircle</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;API1.circle at &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;:&#39;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">radius</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/* Concrete ImplementorB*/</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DrawingAPI2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">DrawingAPI</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="n">drawCircle</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;API2.circle at &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;:&#39;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w">  </span><span class="n">radius</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/* Abstraction*/</span><span class="w"></span>
<span class="k">class</span> <span class="nc">Shape</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">   </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Shape</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">   </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">draw</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">resizeByPercentage</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">pct</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/* Refined Abstraction*/</span><span class="w"></span>
<span class="k">class</span> <span class="nc">CircleShape</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Shape</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">   </span><span class="n">CircleShape</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="kt">double</span><span class="w"> </span><span class="n">radius</span><span class="p">,</span><span class="w"> </span><span class="n">DrawingAPI</span><span class="w"> </span><span class="o">*</span><span class="n">drawingAPI</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"></span>
<span class="w">	   </span><span class="n">m_x</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">m_y</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">m_radius</span><span class="p">(</span><span class="n">radius</span><span class="p">),</span><span class="w"> </span><span class="n">m_drawingAPI</span><span class="p">(</span><span class="n">drawingAPI</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="p">{}</span><span class="w"></span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="n">draw</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">m_drawingAPI</span><span class="o">-&gt;</span><span class="n">drawCircle</span><span class="p">(</span><span class="n">m_x</span><span class="p">,</span><span class="w"> </span><span class="n">m_y</span><span class="p">,</span><span class="w"> </span><span class="n">m_radius</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="n">resizeByPercentage</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">pct</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">m_radius</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">pct</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">   </span><span class="kt">double</span><span class="w"> </span><span class="n">m_x</span><span class="p">,</span><span class="w"> </span><span class="n">m_y</span><span class="p">,</span><span class="w"> </span><span class="n">m_radius</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="n">DrawingAPI</span><span class="w"> </span><span class="o">*</span><span class="n">m_drawingAPI</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">CircleShape</span><span class="w"> </span><span class="n">circle1</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="k">new</span><span class="w"> </span><span class="n">DrawingAPI1</span><span class="p">());</span><span class="w"></span>
<span class="w">   </span><span class="n">CircleShape</span><span class="w"> </span><span class="n">circle2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="k">new</span><span class="w"> </span><span class="n">DrawingAPI2</span><span class="p">());</span><span class="w"></span>
<span class="w">   </span><span class="n">circle1</span><span class="p">.</span><span class="n">resizeByPercentage</span><span class="p">(</span><span class="mf">2.5</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="n">circle2</span><span class="p">.</span><span class="n">resizeByPercentage</span><span class="p">(</span><span class="mf">2.5</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="n">circle1</span><span class="p">.</span><span class="n">draw</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="n">circle2</span><span class="p">.</span><span class="n">draw</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Composite">Composite</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;veaction=edit&amp;section=T-4" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;action=edit&amp;section=T-4" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Composite lets clients treat individual objects and compositions of objects uniformly. The Composite pattern can represent both the conditions. In this pattern, one can develop tree structures for representing part-whole hierarchies.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="c1"> // std::cout</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span><span class="c1"> // std::auto_ptr</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;algorithm&gt;</span><span class="c1"> // std::for_each</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Graphic</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">print</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Graphic</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Ellipse</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Graphic</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">print</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Ellipse </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">CompositeGraphic</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Graphic</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">print</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">Graphic</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nl">a</span><span class="p">:</span><span class="w"> </span><span class="n">graphicList_</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">a</span><span class="o">-&gt;</span><span class="n">print</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="n">Graphic</span><span class="w"> </span><span class="o">*</span><span class="n">aGraphic</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">graphicList_</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">aGraphic</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Graphic</span><span class="o">*&gt;</span><span class="w">  </span><span class="n">graphicList_</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// Initialize four ellipses</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">Ellipse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ellipse1</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Ellipse</span><span class="p">());</span><span class="w"></span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">Ellipse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ellipse2</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Ellipse</span><span class="p">());</span><span class="w"></span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">Ellipse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ellipse3</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Ellipse</span><span class="p">());</span><span class="w"></span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">Ellipse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ellipse4</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Ellipse</span><span class="p">());</span><span class="w"></span>
<span class="w"> </span>
<span class="w">  </span><span class="c1">// Initialize three composite graphics</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">CompositeGraphic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">graphic</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CompositeGraphic</span><span class="p">());</span><span class="w"></span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">CompositeGraphic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">graphic1</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CompositeGraphic</span><span class="p">());</span><span class="w"></span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">CompositeGraphic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">graphic2</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CompositeGraphic</span><span class="p">());</span><span class="w"></span>
<span class="w"> </span>
<span class="w">  </span><span class="c1">// Composes the graphics</span>
<span class="w">  </span><span class="n">graphic1</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="n">ellipse1</span><span class="p">.</span><span class="n">get</span><span class="p">());</span><span class="w"></span>
<span class="w">  </span><span class="n">graphic1</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="n">ellipse2</span><span class="p">.</span><span class="n">get</span><span class="p">());</span><span class="w"></span>
<span class="w">  </span><span class="n">graphic1</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="n">ellipse3</span><span class="p">.</span><span class="n">get</span><span class="p">());</span><span class="w"></span>
<span class="w"> </span>
<span class="w">  </span><span class="n">graphic2</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="n">ellipse4</span><span class="p">.</span><span class="n">get</span><span class="p">());</span><span class="w"></span>
<span class="w"> </span>
<span class="w">  </span><span class="n">graphic</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="n">graphic1</span><span class="p">.</span><span class="n">get</span><span class="p">());</span><span class="w"></span>
<span class="w">  </span><span class="n">graphic</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="n">graphic2</span><span class="p">.</span><span class="n">get</span><span class="p">());</span><span class="w"></span>
<span class="w"> </span>
<span class="w">  </span><span class="c1">// Prints the complete graphic (four times the string &quot;Ellipse&quot;)</span>
<span class="w">  </span><span class="n">graphic</span><span class="o">-&gt;</span><span class="n">print</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Decorator">Decorator</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;veaction=edit&amp;section=T-5" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;action=edit&amp;section=T-5" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The decorator pattern helps to attach additional behavior or responsibilities to an object dynamically. Decorators provide a flexible alternative to subclassing for extending functionality. This is also called â€œWrapperâ€. If your application does some kind of filtering, then Decorator might be good pattern to consider for the job.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Car</span><span class="w"> </span><span class="c1">//Our Abstract base class</span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">protected</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="n">string</span><span class="w"> </span><span class="n">_str</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="n">Car</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Unknown Car&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">                </span><span class="k">virtual</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">getDescription</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w">       </span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="n">_str</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">                </span><span class="k">virtual</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">getCost</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span>
<span class="w">                </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Car</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;~Car()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">OptionsDecorator</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Car</span><span class="w"> </span><span class="c1">//Decorator Base class</span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="k">virtual</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span>
<span class="w">                </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">OptionsDecorator</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;~OptionsDecorator()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">CarModel1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Car</span><span class="w"></span>
<span class="p">{</span><span class="w">       </span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="n">CarModel1</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CarModel1&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="k">virtual</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">getCost</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="mf">31000.23</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">                </span><span class="o">~</span><span class="n">CarModel1</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;~CarModel1()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Navigation</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">OptionsDecorator</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">Car</span><span class="w"> </span><span class="o">*</span><span class="n">_b</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="n">Navigation</span><span class="p">(</span><span class="n">Car</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="n">string</span><span class="w"> </span><span class="n">getDescription</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="n">_b</span><span class="o">-&gt;</span><span class="n">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, Navigation&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">                </span><span class="kt">double</span><span class="w"> </span><span class="n">getCost</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="mf">300.56</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">_b</span><span class="o">-&gt;</span><span class="n">getCost</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="o">~</span><span class="n">Navigation</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;~Navigation()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span><span class="k">delete</span><span class="w"> </span><span class="n">_b</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">PremiumSoundSystem</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">OptionsDecorator</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">Car</span><span class="w"> </span><span class="o">*</span><span class="n">_b</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="n">PremiumSoundSystem</span><span class="p">(</span><span class="n">Car</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="n">string</span><span class="w"> </span><span class="n">getDescription</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="n">_b</span><span class="o">-&gt;</span><span class="n">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, PremiumSoundSystem&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">                </span><span class="kt">double</span><span class="w"> </span><span class="n">getCost</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="mf">0.30</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">_b</span><span class="o">-&gt;</span><span class="n">getCost</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="o">~</span><span class="n">PremiumSoundSystem</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;~PremiumSoundSystem()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span><span class="k">delete</span><span class="w"> </span><span class="n">_b</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">ManualTransmission</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">OptionsDecorator</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">Car</span><span class="w"> </span><span class="o">*</span><span class="n">_b</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="n">ManualTransmission</span><span class="p">(</span><span class="n">Car</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="n">string</span><span class="w"> </span><span class="n">getDescription</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">		        </span><span class="k">return</span><span class="w"> </span><span class="n">_b</span><span class="o">-&gt;</span><span class="n">getDescription</span><span class="p">()</span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, ManualTransmission&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">                </span><span class="kt">double</span><span class="w"> </span><span class="n">getCost</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="mf">0.30</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">_b</span><span class="o">-&gt;</span><span class="n">getCost</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="o">~</span><span class="n">ManualTransmission</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;~ManualTransmission()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span><span class="k">delete</span><span class="w"> </span><span class="n">_b</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//Create our Car that we want to buy</span>
<span class="w">        </span><span class="n">Car</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CarModel1</span><span class="p">();</span><span class="w"></span>

<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Base model of &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">b</span><span class="o">-&gt;</span><span class="n">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; costs $&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">b</span><span class="o">-&gt;</span><span class="n">getCost</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w">  </span>
<span class="w">            </span>
<span class="w">        </span><span class="c1">//Who wants base model let&#39;s add some more features</span>
<span class="w">            </span>
<span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Navigation</span><span class="p">(</span><span class="n">b</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">b</span><span class="o">-&gt;</span><span class="n">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; will cost you $&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">b</span><span class="o">-&gt;</span><span class="n">getCost</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PremiumSoundSystem</span><span class="p">(</span><span class="n">b</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ManualTransmission</span><span class="p">(</span><span class="n">b</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">b</span><span class="o">-&gt;</span><span class="n">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; will cost you $&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">b</span><span class="o">-&gt;</span><span class="n">getCost</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// WARNING! Here we leak the CarModel1, Navigation and PremiumSoundSystem objects!</span>
<span class="w">        </span><span class="c1">// Either we delete them explicitly or rewrite the Decorators to take </span>
<span class="w">        </span><span class="c1">// ownership and delete their Cars when destroyed.</span>
<span class="w">        </span><span class="k">delete</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<p>The output of the program above is:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Base</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">CarModel1</span><span class="w"> </span><span class="n">costs</span><span class="w"> </span><span class="n">$31000</span><span class="mf">.2</span><span class="w"></span>
<span class="n">CarModel1</span><span class="p">,</span><span class="w"> </span><span class="n">Navigation</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cost</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">$31300</span><span class="mf">.8</span><span class="w"></span>
<span class="n">CarModel1</span><span class="p">,</span><span class="w"> </span><span class="n">Navigation</span><span class="p">,</span><span class="w"> </span><span class="n">PremiumSoundSystem</span><span class="p">,</span><span class="w"> </span><span class="n">ManualTransmission</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cost</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">$31301</span><span class="mf">.4</span><span class="w"></span>
<span class="o">~</span><span class="n">ManualTransmission</span><span class="w"></span>
<span class="o">~</span><span class="n">PremiumSoundSystem</span><span class="p">()</span><span class="w"> </span>
<span class="o">~</span><span class="n">Navigation</span><span class="p">()</span><span class="w"></span>
<span class="o">~</span><span class="n">CarModel1</span><span class="w"></span>
<span class="o">~</span><span class="n">Car</span><span class="p">()</span><span class="w"> </span>
<span class="o">~</span><span class="n">OptionsDecorator</span><span class="p">()</span><span class="w"></span>
<span class="o">~</span><span class="n">Car</span><span class="p">()</span><span class="w"> </span>
<span class="o">~</span><span class="n">OptionsDecorator</span><span class="p">()</span><span class="w"></span>
<span class="o">~</span><span class="n">Car</span><span class="p">()</span><span class="w"> </span>
<span class="o">~</span><span class="n">OptionsDecorator</span><span class="p">()</span><span class="w"></span>
<span class="o">~</span><span class="n">Car</span><span class="p">()</span><span class="w"></span>
</pre></div>
<p>Another example(C++14):
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">Interface</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Interface</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Core</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Interface</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	   	</span><span class="o">~</span><span class="n">Core</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Core destructor called.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;}</span><span class="w"></span>
<span class="w">	   	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{};</span><span class="w">  </span><span class="c1">// Do nothing.</span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Decorator</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Interface</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	   	</span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Interface</span><span class="o">&gt;</span><span class="w"> </span><span class="n">interface</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	   	</span><span class="n">Decorator</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Interface</span><span class="o">&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">interface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">c</span><span class="p">);}</span><span class="w"></span>
<span class="w">	   	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="n">interface</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">);}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">MessengerWithSalutation</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Decorator</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	   	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">salutation</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	   	</span><span class="n">MessengerWithSalutation</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Interface</span><span class="o">&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Decorator</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">c</span><span class="p">)),</span><span class="w"> </span><span class="n">salutation</span><span class="p">(</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">	   	</span><span class="o">~</span><span class="n">MessengerWithSalutation</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Messenger destructor called.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;}</span><span class="w"></span>
<span class="w">	   	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		   	</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">salutation</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">text</span><span class="p">;</span><span class="w"></span>
<span class="w">		 	</span><span class="n">Decorator</span><span class="o">::</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">MessengerWithValediction</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Decorator</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	   	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">valediction</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	   	</span><span class="n">MessengerWithValediction</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Interface</span><span class="o">&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Decorator</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">c</span><span class="p">)),</span><span class="w"> </span><span class="n">valediction</span><span class="p">(</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">	   	</span><span class="o">~</span><span class="n">MessengerWithValediction</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;MessengerWithValediction destructor called.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;}</span><span class="w"></span>
<span class="w">	   	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		 	</span><span class="n">Decorator</span><span class="o">::</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">);</span><span class="w"></span>
<span class="w">			</span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">valediction</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">salutation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Greetings,&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">valediction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Sincerly, Andy&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">message1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;This message is not decorated.&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">message2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;This message is decorated with a salutation.&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">message3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;This message is decorated with a valediction.&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">message4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;This message is decorated with a salutation and a valediction.&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Interface</span><span class="o">&gt;</span><span class="w"> </span><span class="n">messenger1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Interface</span><span class="o">&gt;</span><span class="w"> </span><span class="n">messenger2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">MessengerWithSalutation</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">&gt;</span><span class="p">(),</span><span class="w"> </span><span class="n">salutation</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Interface</span><span class="o">&gt;</span><span class="w"> </span><span class="n">messenger3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">MessengerWithValediction</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">&gt;</span><span class="p">(),</span><span class="w"> </span><span class="n">valediction</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Interface</span><span class="o">&gt;</span><span class="w"> </span><span class="n">messenger4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">MessengerWithValediction</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">MessengerWithSalutation</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">  						                  </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Core</span><span class="o">&gt;</span><span class="p">(),</span><span class="w"> </span><span class="n">salutation</span><span class="p">),</span><span class="w"> </span><span class="n">valediction</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="n">messenger1</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">message1</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">message1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">------------------------------</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="n">messenger2</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">message2</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">message2</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">------------------------------</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="n">messenger3</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">message3</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">message3</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">------------------------------</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="n">messenger4</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">message4</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">message4</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">------------------------------</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<p>The output of the program above is:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="n">This</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">decorated</span><span class="p">.</span><span class="w"></span>

<span class="o">------------------------------</span><span class="w"></span>

<span class="n">Greetings</span><span class="p">,</span><span class="w"></span>

<span class="n">This</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">decorated</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">salutation</span><span class="p">.</span><span class="w"></span>

<span class="o">------------------------------</span><span class="w"></span>

<span class="n">This</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">decorated</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">valediction</span><span class="p">.</span><span class="w"></span>

<span class="n">Sincerly</span><span class="p">,</span><span class="w"> </span><span class="n">Andy</span><span class="w"></span>

<span class="o">------------------------------</span><span class="w"></span>

<span class="n">Greetings</span><span class="p">,</span><span class="w"></span>

<span class="n">This</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">decorated</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">salutation</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">valediction</span><span class="p">.</span><span class="w"></span>

<span class="n">Sincerly</span><span class="p">,</span><span class="w"> </span><span class="n">Andy</span><span class="w"></span>

<span class="o">------------------------------</span><span class="w"></span>

<span class="n">MessengerWithValediction</span><span class="w"> </span><span class="n">destructor</span><span class="w"> </span><span class="n">called</span><span class="p">.</span><span class="w"></span>
<span class="n">Messenger</span><span class="w"> </span><span class="n">destructor</span><span class="w"> </span><span class="n">called</span><span class="p">.</span><span class="w"></span>
<span class="n">Core</span><span class="w"> </span><span class="n">destructor</span><span class="w"> </span><span class="n">called</span><span class="p">.</span><span class="w"></span>
<span class="n">MessengerWithValediction</span><span class="w"> </span><span class="n">destructor</span><span class="w"> </span><span class="n">called</span><span class="p">.</span><span class="w"></span>
<span class="n">Core</span><span class="w"> </span><span class="n">destructor</span><span class="w"> </span><span class="n">called</span><span class="p">.</span><span class="w"></span>
<span class="n">Messenger</span><span class="w"> </span><span class="n">destructor</span><span class="w"> </span><span class="n">called</span><span class="p">.</span><span class="w"></span>
<span class="n">Core</span><span class="w"> </span><span class="n">destructor</span><span class="w"> </span><span class="n">called</span><span class="p">.</span><span class="w"></span>
<span class="n">Core</span><span class="w"> </span><span class="n">destructor</span><span class="w"> </span><span class="n">called</span><span class="p">.</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Facade">Facade</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;veaction=edit&amp;section=T-6" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;action=edit&amp;section=T-6" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The Facade Pattern hides the complexities of the system by providing an interface to the client from where the client can access the system on a unified interface. Facade defines a higher-level interface that makes the subsystem easier to use. For instance making one class method perform a complex process by calling several other classes.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cm">/*Facade is one of the easiest patterns I think... And this is very simple example.</span>

<span class="cm">Imagine you set up a smart house where everything is on remote. So to turn the lights on you push lights on button - And same for TV,</span>
<span class="cm">AC, Alarm, Music, etc...</span>

<span class="cm">When you leave a house you would need to push a 100 buttons to make sure everything is off and are good to go which could be little </span>
<span class="cm">annoying if you are lazy like me </span>
<span class="cm">so I defined a Facade for leaving and coming back. (Facade functions represent buttons...) So when I come and leave I just make one </span>
<span class="cm">call and it takes care of everything...</span>
<span class="cm">*/</span><span class="w"></span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Alarm</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">alarmOn</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Alarm is on and house is secured&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">alarmOff</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Alarm is off and you can go into the house&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Ac</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">acOn</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Ac is on&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">acOff</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;AC is off&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Tv</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">tvOn</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Tv is on&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">tvOff</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;TV is off&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">HouseFacade</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">Alarm</span><span class="w"> </span><span class="n">alarm</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">Ac</span><span class="w"> </span><span class="n">ac</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">Tv</span><span class="w"> </span><span class="n">tv</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">HouseFacade</span><span class="p">(){}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">goToWork</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">ac</span><span class="p">.</span><span class="n">acOff</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="n">tv</span><span class="p">.</span><span class="n">tvOff</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="n">alarm</span><span class="p">.</span><span class="n">alarmOn</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">comeHome</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">alarm</span><span class="p">.</span><span class="n">alarmOff</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="n">ac</span><span class="p">.</span><span class="n">acOn</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="n">tv</span><span class="p">.</span><span class="n">tvOn</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">HouseFacade</span><span class="w"> </span><span class="n">hf</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Rather than calling 100 different on and off functions thanks to facade I only have 2 functions...</span>
<span class="w">	</span><span class="n">hf</span><span class="p">.</span><span class="n">goToWork</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="n">hf</span><span class="p">.</span><span class="n">comeHome</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<p>The output of the program above is:
</p>
<pre>AC is off
TV is off
Alarm is on and house is secured
Alarm is off and you can go into the house
Ac is on
Tv is on
</pre>
<h3><span class="mw-headline" id="Flyweight">Flyweight</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;veaction=edit&amp;section=T-7" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;action=edit&amp;section=T-7" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The pattern for saving memory (basically) by sharing properties of objects. Imagine a huge number of similar objects which all have most of their properties the same.  It is natural to move these properties out of these objects to some external data structure and provide each object with the link to that data structure.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span><span class="cp"></span>

<span class="cp">#define NUMBER_OF_SAME_TYPE_CHARS 3;</span>

<span class="cm">/* Actual flyweight objects class (declaration) */</span><span class="w"></span>
<span class="k">class</span> <span class="nc">FlyweightCharacter</span><span class="p">;</span><span class="w"></span>

<span class="cm">/*</span>
<span class="cm">	FlyweightCharacterAbstractBuilder is a class holding the properties which are shared by</span>
<span class="cm">	many objects. So instead of keeping these properties in those objects we keep them externally, making</span>
<span class="cm">	objects flyweight. See more details in the comments of main function.</span>
<span class="cm">*/</span><span class="w"></span>
<span class="k">class</span> <span class="nc">FlyweightCharacterAbstractBuilder</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">FlyweightCharacterAbstractBuilder</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">	</span><span class="o">~</span><span class="n">FlyweightCharacterAbstractBuilder</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fontSizes</span><span class="p">;</span><span class="w"> </span><span class="c1">// lets imagine that sizes may be of floating point type</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fontNames</span><span class="p">;</span><span class="w"> </span><span class="c1">// font name may be of variable length (lets take 6 bytes is average)</span>

<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setFontsAndNames</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">FlyweightCharacter</span><span class="w"> </span><span class="nf">createFlyweightCharacter</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">fontSizeIndex</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">fontNameIndex</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">positionInStream</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="w"> </span><span class="n">FlyweightCharacterAbstractBuilder</span><span class="o">::</span><span class="n">fontSizes</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">FlyweightCharacterAbstractBuilder</span><span class="o">::</span><span class="n">fontNames</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="nf">FlyweightCharacterAbstractBuilder::setFontsAndNames</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">fontSizes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">fontSizes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.5</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">fontSizes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="n">fontNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;first_font&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">fontNames</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;second_font&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">fontNames</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;third_font&quot;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">class</span> <span class="nc">FlyweightCharacter</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">fontSizeIndex</span><span class="p">;</span><span class="w"> </span><span class="c1">// index instead of actual font size</span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">fontNameIndex</span><span class="p">;</span><span class="w"> </span><span class="c1">// index instead of font name</span>

<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">positionInStream</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">	</span><span class="n">FlyweightCharacter</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">fontSizeIndex</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">fontNameIndex</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">positionInStream</span><span class="p">)</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="n">fontSizeIndex</span><span class="p">(</span><span class="n">fontSizeIndex</span><span class="p">),</span><span class="w"> </span><span class="n">fontNameIndex</span><span class="p">(</span><span class="n">fontNameIndex</span><span class="p">),</span><span class="w"> </span><span class="n">positionInStream</span><span class="p">(</span><span class="n">positionInStream</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">print</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Font Size: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">FlyweightCharacterAbstractBuilder</span><span class="o">::</span><span class="n">fontSizes</span><span class="p">[</span><span class="n">fontSizeIndex</span><span class="p">]</span><span class="w"></span>
<span class="w">			</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, font Name: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">FlyweightCharacterAbstractBuilder</span><span class="o">::</span><span class="n">fontNames</span><span class="p">[</span><span class="n">fontNameIndex</span><span class="p">]</span><span class="w"></span>
<span class="w">			</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, character stream position: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">positionInStream</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="o">~</span><span class="n">FlyweightCharacter</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="n">FlyweightCharacter</span><span class="w"> </span><span class="nf">FlyweightCharacterAbstractBuilder::createFlyweightCharacter</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">fontSizeIndex</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">fontNameIndex</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">positionInStream</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">FlyweightCharacter</span><span class="w"> </span><span class="n">fc</span><span class="p">(</span><span class="n">fontSizeIndex</span><span class="p">,</span><span class="w"> </span><span class="n">fontNameIndex</span><span class="p">,</span><span class="w"> </span><span class="n">positionInStream</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">fc</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">FlyweightCharacter</span><span class="o">&gt;</span><span class="w"> </span><span class="n">chars</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="n">FlyweightCharacterAbstractBuilder</span><span class="o">::</span><span class="n">setFontsAndNames</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NUMBER_OF_SAME_TYPE_CHARS</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">limit</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">chars</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">FlyweightCharacterAbstractBuilder</span><span class="o">::</span><span class="n">createFlyweightCharacter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">));</span><span class="w"></span>
<span class="w">		</span><span class="n">chars</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">FlyweightCharacterAbstractBuilder</span><span class="o">::</span><span class="n">createFlyweightCharacter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">limit</span><span class="p">));</span><span class="w"></span>
<span class="w">		</span><span class="n">chars</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">FlyweightCharacterAbstractBuilder</span><span class="o">::</span><span class="n">createFlyweightCharacter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">limit</span><span class="p">));</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="cm">/*</span>
<span class="cm">		Each char stores links to its fontName and fontSize so what we get is:</span>

<span class="cm">		each object instead of allocating 6 bytes (convention above) for string</span>
<span class="cm">		and 4 bytes for float allocates 2 bytes for fontNameIndex and fontSizeIndex.</span>

<span class="cm">		That means for each char we save 6 + 4 - 2 - 2 = 6 bytes.</span>
<span class="cm">		Now imagine we have NUMBER_OF_SAME_TYPE_CHARS = 1000 i.e. with our code</span>
<span class="cm">		we will have 3 groups of chars with 1000 chars in each group which will save </span>
<span class="cm">		3 * 1000 * 6 - (3 * 6 + 3 * 4) = 17970 saved bytes.</span>

<span class="cm">		3 * 6 + 3 * 4 is a number of bytes allocated by FlyweightCharacterAbstractBuilder.</span>

<span class="cm">		So the idea of the pattern is to move properties shared by many objects to some</span>
<span class="cm">		external container. The objects in that case don&#39;t store the data themselves they</span>
<span class="cm">		store only links to the data which saves memory and make the objects lighter.</span>
<span class="cm">		The data size of properties stored externally may be significant which will save REALLY</span>
<span class="cm">		huge amount of memory and will make each object super light in comparison to its counterpart.</span>
<span class="cm">		That&#39;s where the name of the pattern comes from: flyweight (i.e. very light).</span>
<span class="cm">	*/</span><span class="w"></span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">chars</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">chars</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">print</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Proxy">Proxy</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;veaction=edit&amp;section=T-8" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;action=edit&amp;section=T-8" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The Proxy Pattern will provide an object a surrogate or placeholder for another object to control access to it.  It is used when you need to represent a complex object with a simpler one. If creation of an object is expensive, it can be postponed until the very need arises and meanwhile a simpler object can serve as a placeholder. This placeholder object is called the â€œProxyâ€ for the complex object.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">ICar</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">ICar</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ICar destructor!&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">DriveCar</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Car</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">ICar</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">DriveCar</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Car has been driven!&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">ProxyCar</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">ICar</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="n">ProxyCar</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">driver_age</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">driver_age_</span><span class="p">(</span><span class="n">driver_age</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">DriveCar</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">driver_age_</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">real_car_</span><span class="o">-&gt;</span><span class="n">DriveCar</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Sorry, the driver is too young to drive.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">ICar</span><span class="o">&gt;</span><span class="w"> </span><span class="n">real_car_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Car</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">driver_age_</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">ICar</span><span class="o">&gt;</span><span class="w"> </span><span class="n">car</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">ProxyCar</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">car</span><span class="o">-&gt;</span><span class="n">DriveCar</span><span class="p">();</span><span class="w"></span>

<span class="w">  </span><span class="n">car</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">ProxyCar</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">25</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">car</span><span class="o">-&gt;</span><span class="n">DriveCar</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Curiously_Recurring_Template">Curiously Recurring Template</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;veaction=edit&amp;section=T-9" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;action=edit&amp;section=T-9" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This technique is known more widely as a <a href="https://en.wikipedia.org/wiki/Mixin" class="extiw" title="w:Mixin">Mixin</a>. Mixins are described in the literature to be a powerful tool for expressing abstractions<sup class="Template-Fact" style="white-space:nowrap;">&#91;<i><a href="/wiki/Wikibooks:OR" class="mw-redirect" title="Wikibooks:OR"><span title="This claim needs references to reliable sources">citation needed</span></a></i>&#93;</sup>.
</p>
<h3><span id="Interface-based_Programming_.28IBP.29"></span><span class="mw-headline" id="Interface-based_Programming_(IBP)">Interface-based Programming (IBP)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;veaction=edit&amp;section=T-10" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Structural_Patterns&amp;action=edit&amp;section=T-10" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Interface-based programming is closely related with Modular Programming and Object-Oriented Programming, it defines the application as a collection of inter-coupled modules (interconnected and which plug into each other via interface). Modules can be unplugged, replaced, or upgraded, without the need of compromising the contents of other modules.
</p><p>The total system complexity is greatly reduced. Interface Based Programming adds more to  modular Programming in that it insists that Interfaces are to be added to these modules. The entire system is thus viewed as Components and the interfaces that helps them to co-act.
</p><p>Interface-based Programming increases the <i>modularity</i> of the application and hence its maintainability at a later development cycles, especially when each module must be developed by different teams. It is a well-known methodology that has been around for a long time and it is a core technology behind frameworks such as CORBA.<sup class="Template-Fact" style="white-space:nowrap;">&#91;<i><a href="/wiki/Wikibooks:OR" class="mw-redirect" title="Wikibooks:OR"><span title="This claim needs references to reliable sources">citation needed</span></a></i>&#93;</sup>
</p><p>This is particularly convenient when third parties develop additional components for the established system. They just have to develop components that satisfy the interface specified by the parent application vendor.
</p><p>Thus the publisher of the interfaces assures that he will not change the interface and the subscriber agrees to implement the interface as whole without any deviation.
An interface is therefore said to be a <i>Contractual agreement</i> and the <a href="https://en.wikipedia.org/wiki/programming_paradigm" class="extiw" title="w:programming paradigm">programming paradigm</a> based on this is termed as "interface based programming".
</p>
<h2><span class="mw-headline" id="Behavioral_Patterns">Behavioral Patterns</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-1" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-1" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Chain_of_Responsibility">Chain of Responsibility</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-2" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-2" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Chain of Responsibility pattern has the intent to avoid coupling the sender of a request to its receiver by giving more than one object a chance to handle the request. Chains the receiving objects and passes the requests along the chain until an object handles it.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Handler</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">protected</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">Handler</span><span class="w"> </span><span class="o">*</span><span class="n">next</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">Handler</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">            </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Handler</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">request</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">setNextHandler</span><span class="p">(</span><span class="n">Handler</span><span class="w"> </span><span class="o">*</span><span class="n">nextInLine</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nextInLine</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">SpecialHandler</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Handler</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">myLimit</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">myId</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">SpecialHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">limit</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">myLimit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">limit</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">myId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="o">~</span><span class="n">SpecialHandler</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="n">request</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">myLimit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Handler &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">myId</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; handled the request with a limit of &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">myLimit</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">next</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">next</span><span class="o">-&gt;</span><span class="n">request</span><span class="p">(</span><span class="n">value</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Sorry, I am the last handler (&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">myId</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;) and I can&#39;t handle the request.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Handler</span><span class="w"> </span><span class="o">*</span><span class="n">h1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SpecialHandler</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Handler</span><span class="w"> </span><span class="o">*</span><span class="n">h2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SpecialHandler</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Handler</span><span class="w"> </span><span class="o">*</span><span class="n">h3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SpecialHandler</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">h1</span><span class="o">-&gt;</span><span class="n">setNextHandler</span><span class="p">(</span><span class="n">h2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">h2</span><span class="o">-&gt;</span><span class="n">setNextHandler</span><span class="p">(</span><span class="n">h3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">h1</span><span class="o">-&gt;</span><span class="n">request</span><span class="p">(</span><span class="mi">18</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">h1</span><span class="o">-&gt;</span><span class="n">request</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">delete</span><span class="w"> </span><span class="n">h1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">delete</span><span class="w"> </span><span class="n">h2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">delete</span><span class="w"> </span><span class="n">h3</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Command">Command</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-3" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-3" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Command pattern is an Object behavioral pattern that decouples sender and receiver by encapsulating a request as an object, thereby letting you parameterize clients with different requests, queue or log requests, and support undo-able operations. It can also be thought as an object oriented equivalent of call back method. 
</p><p>Call Back:
It is a function that is registered to be called at later point of time based on user actions.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="cm">/*the Command interface*/</span><span class="w"></span>
<span class="k">class</span> <span class="nc">Command</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">execute</span><span class="p">()</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/*Receiver class*/</span><span class="w"></span>
<span class="k">class</span> <span class="nc">Light</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">Light</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">turnOn</span><span class="p">()</span><span class="w"> </span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;The light is on&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">turnOff</span><span class="p">()</span><span class="w"> </span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;The light is off&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/*the Command for turning on the light*/</span><span class="w"></span>
<span class="k">class</span> <span class="nc">FlipUpCommand</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Command</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">	</span><span class="n">FlipUpCommand</span><span class="p">(</span><span class="n">Light</span><span class="o">&amp;</span><span class="w"> </span><span class="n">light</span><span class="p">)</span><span class="o">:</span><span class="n">theLight</span><span class="p">(</span><span class="n">light</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>

<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">execute</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">theLight</span><span class="p">.</span><span class="n">turnOn</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">Light</span><span class="o">&amp;</span><span class="w"> </span><span class="n">theLight</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/*the Command for turning off the light*/</span><span class="w"></span>
<span class="k">class</span> <span class="nc">FlipDownCommand</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Command</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w">   </span>
<span class="w">	</span><span class="n">FlipDownCommand</span><span class="p">(</span><span class="n">Light</span><span class="o">&amp;</span><span class="w"> </span><span class="n">light</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="n">theLight</span><span class="p">(</span><span class="n">light</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>

<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">execute</span><span class="p">()</span><span class="w"> </span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">theLight</span><span class="p">.</span><span class="n">turnOff</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">Light</span><span class="o">&amp;</span><span class="w"> </span><span class="n">theLight</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Switch</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">Switch</span><span class="p">(</span><span class="n">Command</span><span class="o">&amp;</span><span class="w"> </span><span class="n">flipUpCmd</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&amp;</span><span class="w"> </span><span class="n">flipDownCmd</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="o">:</span><span class="n">flipUpCommand</span><span class="p">(</span><span class="n">flipUpCmd</span><span class="p">),</span><span class="n">flipDownCommand</span><span class="p">(</span><span class="n">flipDownCmd</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>

<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">flipUp</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">flipUpCommand</span><span class="p">.</span><span class="n">execute</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">flipDown</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">flipDownCommand</span><span class="p">.</span><span class="n">execute</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">Command</span><span class="o">&amp;</span><span class="w"> </span><span class="n">flipUpCommand</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">Command</span><span class="o">&amp;</span><span class="w"> </span><span class="n">flipDownCommand</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="w"> </span>
<span class="cm">/*The test class or client*/</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">Light</span><span class="w"> </span><span class="n">lamp</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">FlipUpCommand</span><span class="w"> </span><span class="n">switchUp</span><span class="p">(</span><span class="n">lamp</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">FlipDownCommand</span><span class="w"> </span><span class="n">switchDown</span><span class="p">(</span><span class="n">lamp</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="n">Switch</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">switchUp</span><span class="p">,</span><span class="w"> </span><span class="n">switchDown</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">s</span><span class="p">.</span><span class="n">flipUp</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="n">s</span><span class="p">.</span><span class="n">flipDown</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Interpreter">Interpreter</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-4" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-4" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Given a language, define a representation for its grammar along with an interpreter that uses the representation to interpret sentences in the language.
</p><p><br />
</p>
<table style="background: #ffd; border: 1px solid #aaaaaa; padding: 3px; margin: 5px auto; width: 60%" class="notice noprint notice-todo">
<tbody><tr>
<td style="width: 58px;"><div class="floatleft"><img alt="Clipboard" src="//upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/45px-Clipboard.svg.png" decoding="async" width="45" height="45" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/68px-Clipboard.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/90px-Clipboard.svg.png 2x" data-file-width="48" data-file-height="48" /></div>
</td>
<td>
<p><b>To do:</b><br />It would be good to refer the reader to <tt>lex</tt> and <tt>yacc</tt>, and/or its derivatives like flex and bison, for an alternate (time-tested?) approach to these problems.
</p>
</td></tr></tbody></table>
<p><br />
</p><p><br />
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;map&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;list&gt;</span><span class="cp"></span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">wikibooks_design_patterns</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>

<span class="c1">//	based on the Java sample around here</span>

<span class="k">typedef</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">String</span><span class="p">;</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">Expression</span><span class="p">;</span><span class="w"></span>
<span class="k">typedef</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Expression</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">Map</span><span class="p">;</span><span class="w"></span>
<span class="k">typedef</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">Expression</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">Stack</span><span class="p">;</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">Expression</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">interpret</span><span class="p">(</span><span class="n">Map</span><span class="w"> </span><span class="n">variables</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Expression</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Number</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Expression</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">;</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"> </span>
<span class="w">	</span><span class="n">Number</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">)</span><span class="w">       </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">interpret</span><span class="p">(</span><span class="n">Map</span><span class="w"> </span><span class="n">variables</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">number</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Plus</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Expression</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">leftOperand</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">rightOperand</span><span class="p">;</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"> </span>

<span class="w">    </span><span class="n">Plus</span><span class="p">(</span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">        </span><span class="n">leftOperand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">left</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="n">rightOperand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">right</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">Plus</span><span class="p">(){</span><span class="w"> </span>
<span class="w">	</span><span class="k">delete</span><span class="w"> </span><span class="n">leftOperand</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">delete</span><span class="w"> </span><span class="n">rightOperand</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">interpret</span><span class="p">(</span><span class="n">Map</span><span class="w"> </span><span class="n">variables</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"> </span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">leftOperand</span><span class="o">-&gt;</span><span class="n">interpret</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rightOperand</span><span class="o">-&gt;</span><span class="n">interpret</span><span class="p">(</span><span class="n">variables</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Minus</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Expression</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">leftOperand</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">rightOperand</span><span class="p">;</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"> </span>
<span class="w">    </span><span class="n">Minus</span><span class="p">(</span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">        </span><span class="n">leftOperand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">left</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="n">rightOperand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">right</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">Minus</span><span class="p">(){</span><span class="w"> </span>
<span class="w">	</span><span class="k">delete</span><span class="w"> </span><span class="n">leftOperand</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">delete</span><span class="w"> </span><span class="n">rightOperand</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">interpret</span><span class="p">(</span><span class="n">Map</span><span class="w"> </span><span class="n">variables</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"> </span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">leftOperand</span><span class="o">-&gt;</span><span class="n">interpret</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rightOperand</span><span class="o">-&gt;</span><span class="n">interpret</span><span class="p">(</span><span class="n">variables</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Variable</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Expression</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"> </span>
<span class="w">	</span><span class="n">Variable</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w">       </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">interpret</span><span class="p">(</span><span class="n">Map</span><span class="w"> </span><span class="n">variables</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"> </span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">variables</span><span class="p">.</span><span class="n">end</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">variables</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">variables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">interpret</span><span class="p">(</span><span class="n">variables</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">//	While the interpreter pattern does not address parsing, a parser is provided for completeness.</span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Evaluator</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Expression</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">syntaxTree</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">Evaluator</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">expression</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">Stack</span><span class="w"> </span><span class="n">expressionStack</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="kt">size_t</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">String</span><span class="o">::</span><span class="n">npos</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">last</span><span class="p">;</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="o">::</span><span class="n">npos</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nl">next</span> <span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">next</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	    </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expression</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="sc">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">last</span><span class="p">);</span><span class="w"></span>
<span class="w">	    </span><span class="n">String</span><span class="w"> </span><span class="nf">token</span><span class="p">(</span><span class="w"> </span><span class="n">expression</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">last</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="o">::</span><span class="n">npos</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="n">expression</span><span class="p">.</span><span class="n">length</span><span class="p">()</span><span class="o">-</span><span class="n">last</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">next</span><span class="o">-</span><span class="n">last</span><span class="p">)));</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w">  </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;+&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">back</span><span class="p">();</span><span class="w"> </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">back</span><span class="p">();</span><span class="w"> </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">subExpression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Plus</span><span class="p">(</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">left</span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">subExpression</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">// it&#39;s necessary remove first the right operand from the stack</span>
<span class="w">                </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">back</span><span class="p">();</span><span class="w"> </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="c1">// ..and after the left one</span>
<span class="w">                </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">back</span><span class="p">();</span><span class="w"> </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="n">Expression</span><span class="o">*</span><span class="w"> </span><span class="n">subExpression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Minus</span><span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">right</span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">subExpression</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w">                        </span>
<span class="w">                </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Variable</span><span class="p">(</span><span class="n">token</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="n">syntaxTree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">back</span><span class="p">();</span><span class="w"> </span><span class="n">expressionStack</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">     </span><span class="o">~</span><span class="n">Evaluator</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">delete</span><span class="w"> </span><span class="n">syntaxTree</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">interpret</span><span class="p">(</span><span class="n">Map</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">syntaxTree</span><span class="o">-&gt;</span><span class="n">interpret</span><span class="p">(</span><span class="n">context</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">wikibooks_design_patterns</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="n">Evaluator</span><span class="w"> </span><span class="nf">sentence</span><span class="p">(</span><span class="s">&quot;w x z - +&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="k">static</span><span class="w"></span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">sequences</span><span class="p">[][</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">-5</span><span class="p">},</span><span class="w"></span>
<span class="w">	</span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">sequences</span><span class="p">)</span><span class="o">/</span><span class="k">sizeof</span><span class="p">(</span><span class="n">sequences</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">Map</span><span class="w"> </span><span class="n">variables</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">variables</span><span class="p">[</span><span class="s">&quot;w&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Number</span><span class="p">(</span><span class="n">sequences</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span><span class="w"></span>
<span class="w">		</span><span class="n">variables</span><span class="p">[</span><span class="s">&quot;x&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Number</span><span class="p">(</span><span class="n">sequences</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w">		</span><span class="n">variables</span><span class="p">[</span><span class="s">&quot;z&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Number</span><span class="p">(</span><span class="n">sequences</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]);</span><span class="w"></span>
<span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sentence</span><span class="p">.</span><span class="n">interpret</span><span class="p">(</span><span class="n">variables</span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Map</span><span class="o">::</span><span class="n">iterator</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">variables</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span><span class="w"> </span><span class="n">variables</span><span class="p">.</span><span class="n">end</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">it</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">it</span><span class="p">)</span><span class="w"> </span><span class="k">delete</span><span class="w"> </span><span class="n">it</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;Interpreter result: &quot;</span><span class="o">&lt;&lt;</span><span class="n">result</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Iterator">Iterator</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-5" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-5" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The 'iterator' design pattern is used liberally within the STL for traversal of various containers. The full understanding of this will liberate a developer to create highly reusable and easily understandable<sup class="Template-Fact" style="white-space:nowrap;">&#91;<i><a href="/wiki/Wikibooks:OR" class="mw-redirect" title="Wikibooks:OR"><span title="This claim needs references to reliable sources">citation needed</span></a></i>&#93;</sup> data containers.
</p><p>The basic idea of the iterator is that it permits the traversal of a container (like a pointer moving across an array). However, to get to the next element of a container, you need not know anything about how the container is constructed. This is the iterators job. By simply using the member functions provided by the iterator, you can move, in the intended order of the container, from the first element to the last element.
</p><p>Let us start by considering a traditional single dimensional array with a pointer moving from the start to the end. This example assumes knowledge of pointer arithmetic.
Note that the use of "it" or "itr," henceforth, is a short version of "iterator."
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ARRAY_LEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">myArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="n">ARRAY_LEN</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="c1">// Set the iterator to point to the first memory location of the array</span>
<span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">arrayItr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myArray</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="c1">// Move through each element of the array, setting it equal to its position in the array</span>
<span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ARRAY_LEN</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// set the value of the current location in the array</span>
<span class="w">    </span><span class="o">*</span><span class="n">arrayItr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// by incrementing the pointer, we move it to the next position in the array.</span>
<span class="w">    </span><span class="c1">// This is easy for a contiguous memory container, since pointer arithmetic </span>
<span class="w">    </span><span class="c1">// handles the traversal.</span>
<span class="w">    </span><span class="o">++</span><span class="n">arrayItr</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="c1">// Do not be messy, clean up after yourself</span>
<span class="w"> </span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">myArray</span><span class="p">;</span><span class="w"></span>
</pre></div>
<p>This code works very quickly for arrays, but how would we traverse a linked list, when the memory is not contiguous?
Consider the implementation of a rudimentary linked list as follows:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="w"> </span><span class="k">class</span> <span class="nc">IteratorCannotMoveToNext</span><span class="p">{};</span><span class="w"> </span><span class="c1">// Error class</span>
<span class="w"> </span><span class="k">class</span> <span class="nc">MyIntLList</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="c1">// The Node class represents a single element in the linked list. </span>
<span class="w">     </span><span class="c1">// The node has a next node and a previous node, so that the user </span>
<span class="w">     </span><span class="c1">// may move from one position to the next, or step back a single </span>
<span class="w">     </span><span class="c1">// position. Notice that the traversal of a linked list is O(N), </span>
<span class="w">     </span><span class="c1">// as is searching, since the list is not ordered.</span>
<span class="w">     </span><span class="k">class</span> <span class="nc">Node</span><span class="w"></span>
<span class="w">     </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">         </span><span class="n">Node</span><span class="p">()</span><span class="o">:</span><span class="n">mNextNode</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">mPrevNode</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">mValue</span><span class="p">(</span><span class="mi">0</span><span class="p">){}</span><span class="w"></span>
<span class="w">         </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">mNextNode</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">mPrevNode</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="kt">int</span><span class="w"> </span><span class="n">mValue</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="p">};</span><span class="w"></span>
<span class="w">     </span><span class="n">MyIntLList</span><span class="p">()</span><span class="o">:</span><span class="n">mSize</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span>
<span class="w">     </span><span class="p">{}</span><span class="w"></span>
<span class="w">     </span><span class="o">~</span><span class="n">MyIntLList</span><span class="p">()</span><span class="w"></span>
<span class="w">     </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">Empty</span><span class="p">())</span><span class="w"></span>
<span class="w">             </span><span class="n">pop_front</span><span class="p">();</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"> </span><span class="c1">// See expansion for further implementation;</span>
<span class="w">     </span><span class="kt">int</span><span class="w"> </span><span class="n">Size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">mSize</span><span class="p">;}</span><span class="w"></span>
<span class="w">     </span><span class="c1">// Add this value to the end of the list</span>
<span class="w">     </span><span class="kt">void</span><span class="w"> </span><span class="n">push_back</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">newNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Node</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="n">newNode</span><span class="o">-&gt;</span><span class="n">mValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="n">newNode</span><span class="o">-&gt;</span><span class="n">mPrevNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mTail</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="n">mTail</span><span class="o">-&gt;</span><span class="n">mNextNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newNode</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="n">mTail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newNode</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="o">++</span><span class="n">mSize</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="w">     </span><span class="c1">// Remove the value from the beginning of the list</span>
<span class="w">     </span><span class="kt">void</span><span class="w"> </span><span class="n">pop_front</span><span class="p">()</span><span class="w"></span>
<span class="w">     </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="p">(</span><span class="n">Empty</span><span class="p">())</span><span class="w"></span>
<span class="w">             </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">tmpnode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mHead</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="n">mHead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mHead</span><span class="o">-&gt;</span><span class="n">mNextNode</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="k">delete</span><span class="w"> </span><span class="n">tmpnode</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="o">--</span><span class="n">mSize</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="w">     </span><span class="kt">bool</span><span class="w"> </span><span class="n">Empty</span><span class="p">()</span><span class="w"></span>
<span class="w">     </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">mSize</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;}</span><span class="w"></span>
<span class="w"> </span>
<span class="w">     </span><span class="c1">// This is where the iterator definition will go, </span>
<span class="w">     </span><span class="c1">// but lets finish the definition of the list, first</span>
<span class="w"> </span>
<span class="w"> </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">     </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">mHead</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">mTail</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="kt">int</span><span class="w"> </span><span class="n">mSize</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>
</pre></div>
<p>This linked list has non-contiguous memory, and is therefore not a candidate for pointer arithmetic. And we do not want to expose the internals of the list to other developers, forcing them to learn them, and keeping us from changing it.
</p><p>This is where the iterator comes in. The common interface makes learning the usage of the container easier, and hides the traversal logic from other developers.
</p><p>Let us examine the code for the iterator, itself.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="w">     </span><span class="cm">/*</span>
<span class="cm">      *  The iterator class knows the internals of the linked list, so that it </span>
<span class="cm">      *  may move from one element to the next. In this implementation, I have </span>
<span class="cm">      *  chosen the classic traversal method of overloading the increment </span>
<span class="cm">      *  operators. More thorough implementations of a bi-directional linked </span>
<span class="cm">      *  list would include decrement operators so that the iterator may move </span>
<span class="cm">      *  in the opposite direction.</span>
<span class="cm">      */</span><span class="w"></span>
<span class="w">     </span><span class="k">class</span> <span class="nc">Iterator</span><span class="w"></span>
<span class="w">     </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">         </span><span class="n">Iterator</span><span class="p">(</span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">position</span><span class="p">)</span><span class="o">:</span><span class="n">mCurrNode</span><span class="p">(</span><span class="n">position</span><span class="p">){}</span><span class="w"></span>
<span class="w">         </span><span class="c1">// Prefix increment</span>
<span class="w">         </span><span class="k">const</span><span class="w"> </span><span class="n">Iterator</span><span class="w"> </span><span class="o">&amp;</span><span class="k">operator</span><span class="o">++</span><span class="p">()</span><span class="w"></span>
<span class="w">         </span><span class="p">{</span><span class="w"></span>
<span class="w">             </span><span class="k">if</span><span class="p">(</span><span class="n">mCurrNode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mCurrNode</span><span class="o">-&gt;</span><span class="n">mNextNode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                 </span><span class="k">throw</span><span class="w"> </span><span class="n">IteratorCannotMoveToNext</span><span class="p">();</span><span class="n">e</span><span class="w"></span>
<span class="w">             </span><span class="n">mCurrNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mCurrNode</span><span class="o">-&gt;</span><span class="n">mNextNode</span><span class="p">;</span><span class="w"></span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="p">}</span><span class="w"></span>
<span class="w">         </span><span class="c1">// Postfix increment</span>
<span class="w">         </span><span class="n">Iterator</span><span class="w"> </span><span class="k">operator</span><span class="o">++</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="p">{</span><span class="w"></span>
<span class="w">             </span><span class="n">Iterator</span><span class="w"> </span><span class="n">tempItr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="w">             </span><span class="o">++</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">             </span><span class="k">return</span><span class="w"> </span><span class="n">tempItr</span><span class="p">;</span><span class="w"></span>
<span class="w">         </span><span class="p">}</span><span class="w"></span>
<span class="w">         </span><span class="c1">// Dereferencing operator returns the current node, which should then </span>
<span class="w">         </span><span class="c1">// be dereferenced for the int. TODO: Check syntax for overloading </span>
<span class="w">         </span><span class="c1">// dereferencing operator</span>
<span class="w">         </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">operator</span><span class="o">*</span><span class="p">()</span><span class="w"></span>
<span class="w">         </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">mCurrNode</span><span class="p">;}</span><span class="w"></span>
<span class="w">         </span><span class="c1">// TODO: implement arrow operator and clean up example usage following</span>
<span class="w">     </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">         </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">mCurrNode</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="p">};</span><span class="w"></span>
<span class="w">     </span><span class="c1">// The following two functions make it possible to create </span>
<span class="w">     </span><span class="c1">// iterators for an instance of this class.</span>
<span class="w">     </span><span class="c1">// First position for iterators should be the first element in the container.</span>
<span class="w">     </span><span class="n">Iterator</span><span class="w"> </span><span class="nf">Begin</span><span class="p">(){</span><span class="k">return</span><span class="w"> </span><span class="n">Iterator</span><span class="p">(</span><span class="n">mHead</span><span class="p">);}</span><span class="w"></span>
<span class="w">     </span><span class="c1">// Final position for iterators should be one past the last element in the container.</span>
<span class="w">     </span><span class="n">Iterator</span><span class="w"> </span><span class="nf">End</span><span class="p">(){</span><span class="k">return</span><span class="w"> </span><span class="n">Iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">);}</span><span class="w"></span>
</pre></div>
<p>With this implementation, it is now possible, without knowledge of the size of the container or how its data is organized, to move through each element in order, manipulating or simply accessing the data. This is done through the accessors in the MyIntLList class, Begin() and End().
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="w"> </span><span class="c1">// Create a list</span>
<span class="w"> </span><span class="n">MyIntLList</span><span class="w"> </span><span class="n">myList</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="c1">// Add some items to the list</span>
<span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="n">myList</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="c1">// Move through the list, adding 42 to each item.</span>
<span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="n">MyIntLList</span><span class="o">::</span><span class="n">Iterator</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myList</span><span class="p">.</span><span class="n">Begin</span><span class="p">();</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">myList</span><span class="p">.</span><span class="n">End</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">it</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="o">*</span><span class="n">it</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">mValue</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">42</span><span class="p">;</span><span class="w"></span>
</pre></div>
<p><br />
</p>
<table style="background: #ffd; border: 1px solid #aaaaaa; padding: 3px; margin: 5px auto; width: 60%" class="notice noprint notice-todo">
<tbody><tr>
<td style="width: 58px;"><div class="floatleft"><img alt="Clipboard" src="//upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/45px-Clipboard.svg.png" decoding="async" width="45" height="45" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/68px-Clipboard.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/90px-Clipboard.svg.png 2x" data-file-width="48" data-file-height="48" /></div>
</td>
<td>
<p><b>To do:</b><br />
</p>
<ul><li>Discussion of iterators in the STL, and the usefulness of iterators within the algorithms library.</li>
<li>Iterators best practices</li>
<li>Warnings on creation of and usage of</li>
<li>When use of operator[] is better and simplifies understanding</li>
<li>Cautions about the impact of templates on generated code size (this could make for a good student research paper)</li></ul>
</td></tr></tbody></table>
<p><br />
</p><p>The following program gives the implementation of an iterator design pattern with a generic template:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cm">/************************************************************************/</span><span class="w"></span>
<span class="cm">/* Iterator.h                                                           */</span><span class="w"></span>
<span class="cm">/************************************************************************/</span><span class="w"></span>
<span class="cp">#ifndef MY_ITERATOR_HEADER</span>
<span class="cp">#define MY_ITERATOR_HEADER</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iterator&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;set&gt;</span><span class="cp"></span>

<span class="c1">//////////////////////////////////////////////////////////////////////////</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">class</span> <span class="nc">U</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">Iterator</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">typedef</span><span class="w"> </span><span class="k">typename</span> <span class="nc">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">iterator</span><span class="w"> </span><span class="n">iter_type</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">Iterator</span><span class="p">(</span><span class="n">U</span><span class="w"> </span><span class="o">*</span><span class="n">pData</span><span class="p">)</span><span class="o">:</span><span class="n">m_pData</span><span class="p">(</span><span class="n">pData</span><span class="p">){</span><span class="w"></span>
<span class="w">		</span><span class="n">m_it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_pData</span><span class="o">-&gt;</span><span class="n">m_data</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">first</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_pData</span><span class="o">-&gt;</span><span class="n">m_data</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">next</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_it</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">bool</span><span class="w"> </span><span class="n">isDone</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">m_it</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">m_pData</span><span class="o">-&gt;</span><span class="n">m_data</span><span class="p">.</span><span class="n">end</span><span class="p">());</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="n">iter_type</span><span class="w"> </span><span class="n">current</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">m_it</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">U</span><span class="w"> </span><span class="o">*</span><span class="n">m_pData</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">iter_type</span><span class="w"> </span><span class="n">m_it</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">class</span> <span class="nc">U</span><span class="p">,</span><span class="w"> </span><span class="k">class</span> <span class="nc">A</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">setIterator</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="k">typedef</span><span class="w"> </span><span class="k">typename</span> <span class="nc">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">U</span><span class="o">&gt;::</span><span class="n">iterator</span><span class="w"> </span><span class="n">iter_type</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="n">setIterator</span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="n">pData</span><span class="p">)</span><span class="o">:</span><span class="n">m_pData</span><span class="p">(</span><span class="n">pData</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_pData</span><span class="o">-&gt;</span><span class="n">m_data</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">first</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_pData</span><span class="o">-&gt;</span><span class="n">m_data</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">next</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_it</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">bool</span><span class="w"> </span><span class="n">isDone</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">m_it</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">m_pData</span><span class="o">-&gt;</span><span class="n">m_data</span><span class="p">.</span><span class="n">end</span><span class="p">());</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="n">iter_type</span><span class="w"> </span><span class="n">current</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">m_it</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">A</span><span class="w">			</span><span class="o">*</span><span class="n">m_pData</span><span class="p">;</span><span class="w">		</span>
<span class="w">	</span><span class="n">iter_type</span><span class="w">		</span><span class="n">m_it</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="cp">#endif</span>
</pre></div>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cm">/************************************************************************/</span><span class="w"></span>
<span class="cm">/* Aggregate.h                                                          */</span><span class="w"></span>
<span class="cm">/************************************************************************/</span><span class="w"></span>
<span class="cp">#ifndef MY_DATACOLLECTION_HEADER</span>
<span class="cp">#define MY_DATACOLLECTION_HEADER</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Iterator.h&quot;</span><span class="cp"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">aggregate</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">friend</span><span class="w"> </span><span class="k">class</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">aggregate</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_data</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="n">Iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">aggregate</span><span class="o">&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">create_iterator</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">aggregate</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_data</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">class</span> <span class="nc">U</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">aggregateSet</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">friend</span><span class="w"> </span><span class="k">class</span> <span class="nc">setIterator</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">U</span><span class="p">,</span><span class="w"> </span><span class="n">aggregateSet</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_data</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="n">setIterator</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">U</span><span class="p">,</span><span class="w"> </span><span class="n">aggregateSet</span><span class="o">&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">create_iterator</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">setIterator</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">aggregateSet</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">Print</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">copy</span><span class="p">(</span><span class="n">m_data</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">m_data</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">ostream_iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">));</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">U</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_data</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cp">#endif</span>
</pre></div>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cm">/************************************************************************/</span><span class="w"></span>
<span class="cm">/* Iterator Test.cpp                                                    */</span><span class="w"></span>
<span class="cm">/************************************************************************/</span><span class="w"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Aggregate.h&quot;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Money</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">Money</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">m_data</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="w">	</span><span class="kt">void</span><span class="w"> </span><span class="n">SetMoney</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">m_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">GetMoney</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">m_data</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">m_data</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Name</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">Name</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">m_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">GetName</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">m_name</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">friend</span><span class="w"> </span><span class="n">ostream</span><span class="w"> </span><span class="o">&amp;</span><span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">ostream</span><span class="o">&amp;</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">out</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">GetName</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	</span><span class="n">string</span><span class="w"> </span><span class="n">m_name</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">NameLess</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="kt">bool</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="o">&amp;</span><span class="n">lhs</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">lhs</span><span class="p">.</span><span class="n">GetName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">rhs</span><span class="p">.</span><span class="n">GetName</span><span class="p">());</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="c1">//sample 1</span>
<span class="w">	</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;________________Iterator with int______________________________________&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">aggregate</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">agg</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">agg</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="n">Iterator</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="n">aggregate</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">agg</span><span class="p">.</span><span class="n">create_iterator</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="k">for</span><span class="p">(</span><span class="n">it</span><span class="o">-&gt;</span><span class="n">first</span><span class="p">();</span><span class="w"> </span><span class="o">!</span><span class="n">it</span><span class="o">-&gt;</span><span class="n">isDone</span><span class="p">();</span><span class="w"> </span><span class="n">it</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">())</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">*</span><span class="n">it</span><span class="o">-&gt;</span><span class="n">current</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w">	</span>

<span class="w">	</span><span class="c1">//sample 2</span>
<span class="w">	</span><span class="n">aggregate</span><span class="o">&lt;</span><span class="n">Money</span><span class="o">&gt;</span><span class="w"> </span><span class="n">agg2</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">Money</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">agg2</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">agg2</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">b</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">agg2</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;________________Iterator with Class Money______________________________&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Money</span><span class="p">,</span><span class="w"> </span><span class="n">aggregate</span><span class="o">&lt;</span><span class="n">Money</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">it2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">agg2</span><span class="p">.</span><span class="n">create_iterator</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">it2</span><span class="o">-&gt;</span><span class="n">first</span><span class="p">();</span><span class="w"> </span><span class="o">!</span><span class="n">it2</span><span class="o">-&gt;</span><span class="n">isDone</span><span class="p">();</span><span class="w"> </span><span class="n">it2</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">())</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">it2</span><span class="o">-&gt;</span><span class="n">current</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">GetMoney</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//sample 3</span>
<span class="w">	</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;________________Set Iterator with Class Name______________________________&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="n">aggregateSet</span><span class="o">&lt;</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">NameLess</span><span class="o">&gt;</span><span class="w"> </span><span class="n">aset</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">aset</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Name</span><span class="p">(</span><span class="s">&quot;Qmt&quot;</span><span class="p">));</span><span class="w"></span>
<span class="w">	</span><span class="n">aset</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Name</span><span class="p">(</span><span class="s">&quot;Bmt&quot;</span><span class="p">));</span><span class="w"></span>
<span class="w">	</span><span class="n">aset</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Name</span><span class="p">(</span><span class="s">&quot;Cmt&quot;</span><span class="p">));</span><span class="w"></span>
<span class="w">	</span><span class="n">aset</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Name</span><span class="p">(</span><span class="s">&quot;Amt&quot;</span><span class="p">));</span><span class="w"></span>

<span class="w">	</span><span class="n">setIterator</span><span class="o">&lt;</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">NameLess</span><span class="p">,</span><span class="w"> </span><span class="n">aggregateSet</span><span class="o">&lt;</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">NameLess</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">it3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aset</span><span class="p">.</span><span class="n">create_iterator</span><span class="p">();</span><span class="w"></span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">it3</span><span class="o">-&gt;</span><span class="n">first</span><span class="p">();</span><span class="w"> </span><span class="o">!</span><span class="n">it3</span><span class="o">-&gt;</span><span class="n">isDone</span><span class="p">();</span><span class="w"> </span><span class="n">it3</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">())</span><span class="w"></span>
<span class="w">		</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">it3</span><span class="o">-&gt;</span><span class="n">current</span><span class="p">())</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<p>Console output:
</p>
<pre>________________Iterator with int______________________________________
0
1
2
3
4
5
6
7
8
9
________________Iterator with Class Money______________________________
100
1000
10000
________________Set Iterator with Class Name___________________________
Amt
Bmt
Cmt
Qmt
</pre>
<h3><span class="mw-headline" id="Mediator">Mediator</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-6" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-6" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Define an object that encapsulates how a set of objects interact. Mediator promotes loose coupling by keeping objects from  referring to each other explicitly, and it lets you vary their interaction independently.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;list&gt;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">MediatorInterface</span><span class="p">;</span><span class="w"></span>

<span class="k">class</span> <span class="nc">ColleagueInterface</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="n">ColleagueInterface</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">newName</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">(</span><span class="n">newName</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;}</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">sendMessage</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MediatorInterface</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">receiveMessage</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ColleagueInterface</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Colleague</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">ColleagueInterface</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="k">using</span><span class="w"> </span><span class="n">ColleagueInterface</span><span class="o">::</span><span class="n">ColleagueInterface</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">sendMessage</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MediatorInterface</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">receiveMessage</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ColleagueInterface</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">MediatorInterface</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">ColleagueInterface</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">colleagueList</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    	</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">ColleagueInterface</span><span class="o">*&gt;&amp;</span><span class="w"> </span><span class="n">getColleagueList</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">colleagueList</span><span class="p">;}</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">distributeMessage</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ColleagueInterface</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerColleague</span><span class="w"> </span><span class="p">(</span><span class="n">ColleagueInterface</span><span class="o">*</span><span class="w"> </span><span class="n">colleague</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">colleagueList</span><span class="p">.</span><span class="n">emplace_back</span><span class="w"> </span><span class="p">(</span><span class="n">colleague</span><span class="p">);}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Mediator</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">MediatorInterface</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">distributeMessage</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ColleagueInterface</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Colleague::sendMessage</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MediatorInterface</span><span class="o">&amp;</span><span class="w"> </span><span class="n">mediator</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">mediator</span><span class="p">.</span><span class="n">distributeMessage</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Colleague::receiveMessage</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ColleagueInterface</span><span class="o">*</span><span class="w"> </span><span class="n">sender</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> 	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; received the message from &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">sender</span><span class="o">-&gt;</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w">			</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Mediator::distributeMessage</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ColleagueInterface</span><span class="o">*</span><span class="w"> </span><span class="n">sender</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ColleagueInterface</span><span class="o">*</span><span class="w"> </span><span class="nl">x</span> <span class="p">:</span><span class="w"> </span><span class="n">getColleagueList</span><span class="p">())</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">sender</span><span class="p">)</span><span class="w">  </span><span class="c1">// Do not send the message back to the sender</span>
<span class="w">			</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">receiveMessage</span><span class="w"> </span><span class="p">(</span><span class="n">sender</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">Colleague</span><span class="w"> </span><span class="o">*</span><span class="n">bob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Colleague</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Bob&quot;</span><span class="p">),</span><span class="w">  </span><span class="o">*</span><span class="n">sam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Colleague</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Sam&quot;</span><span class="p">),</span><span class="w">  </span><span class="o">*</span><span class="n">frank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Colleague</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Frank&quot;</span><span class="p">),</span><span class="w">  </span><span class="o">*</span><span class="n">tom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Colleague</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Tom&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">Colleague</span><span class="o">*</span><span class="w"> </span><span class="n">staff</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">bob</span><span class="p">,</span><span class="w"> </span><span class="n">sam</span><span class="p">,</span><span class="w"> </span><span class="n">frank</span><span class="p">,</span><span class="w"> </span><span class="n">tom</span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="n">Mediator</span><span class="w"> </span><span class="n">mediatorStaff</span><span class="p">,</span><span class="w"> </span><span class="n">mediatorSamsBuddies</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Colleague</span><span class="o">*</span><span class="w"> </span><span class="nl">x</span> <span class="p">:</span><span class="w"> </span><span class="n">staff</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">mediatorStaff</span><span class="p">.</span><span class="n">registerColleague</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">bob</span><span class="o">-&gt;</span><span class="n">sendMessage</span><span class="w"> </span><span class="p">(</span><span class="n">mediatorStaff</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;I&#39;m quitting this job!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">mediatorSamsBuddies</span><span class="p">.</span><span class="n">registerColleague</span><span class="w"> </span><span class="p">(</span><span class="n">frank</span><span class="p">);</span><span class="w">  </span><span class="n">mediatorSamsBuddies</span><span class="p">.</span><span class="n">registerColleague</span><span class="w"> </span><span class="p">(</span><span class="n">tom</span><span class="p">);</span><span class="w">  </span><span class="c1">// Sam&#39;s buddies only</span>
<span class="w">	</span><span class="n">sam</span><span class="o">-&gt;</span><span class="n">sendMessage</span><span class="w"> </span><span class="p">(</span><span class="n">mediatorSamsBuddies</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Hooray!  He&#39;s gone!  Let&#39;s go for a drink, guys!&quot;</span><span class="p">);</span><span class="w">	</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Memento">Memento</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-7" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-7" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Without violating encapsulation the Memento Pattern will capture and externalize an objectâ€™s internal state so that the object can be restored to this state later. Though the <a href="https://en.wikipedia.org/wiki/Design_Patterns" class="extiw" title="w:Design Patterns">Gang of Four</a> uses friend as a way to implement this pattern it is not the best design<sup class="Template-Fact" style="white-space:nowrap;">&#91;<i><a href="/wiki/Wikibooks:OR" class="mw-redirect" title="Wikibooks:OR"><span title="This claim needs references to reliable sources">citation needed</span></a></i>&#93;</sup>.  It can also be implemented using <a href="https://en.wikipedia.org/wiki/Opaque_pointer" class="extiw" title="w:Opaque pointer">PIMPL (pointer to implementation or opaque pointer)</a>.  Best Use case is 'Undo-Redo' in an editor. 
</p><p>The Originator (the object to be saved) creates a snap-shot of itself as a Memento object, and passes that reference to the Caretaker object.  The Caretaker object keeps the Memento until such a time as the Originator may want to revert to a previous state as recorded in the Memento object.
</p><p>See <a rel="nofollow" class="external text" href="http://perldoc.perl.org/Memoize.html">memoize</a> for an <i>old-school</i> example of this pattern.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span><span class="cp"></span>

<span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Object&quot;</span><span class="p">;</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">toString</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">t</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Memento</span><span class="p">;</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Object</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    	    </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<span class="w">    	    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"></span>
<span class="w">    	    </span><span class="kt">double</span><span class="w"> </span><span class="n">decimal</span><span class="p">;</span><span class="w">  </span><span class="c1">// and suppose there are loads of other data members</span>
<span class="w">  	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	    </span><span class="n">Object</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">newValue</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="p">(</span><span class="n">newValue</span><span class="p">),</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">(</span><span class="n">NAME</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">toString</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)),</span><span class="w"> </span><span class="n">decimal</span><span class="w"> </span><span class="p">((</span><span class="kt">float</span><span class="p">)</span><span class="n">value</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">	    </span><span class="kt">void</span><span class="w"> </span><span class="n">doubleValue</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">toString</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">);</span><span class="w">  </span><span class="n">decimal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">value</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="p">;}</span><span class="w"></span>
<span class="w">	    </span><span class="kt">void</span><span class="w"> </span><span class="n">increaseByOne</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">value</span><span class="o">++</span><span class="p">;</span><span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">toString</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">);</span><span class="w">  </span><span class="n">decimal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">value</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="p">;}</span><span class="w"></span>
<span class="w">	    </span><span class="kt">int</span><span class="w"> </span><span class="n">getValue</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">;}</span><span class="w"></span>
<span class="w">	    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;}</span><span class="w"></span>
<span class="w">	    </span><span class="kt">double</span><span class="w"> </span><span class="n">getDecimal</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">decimal</span><span class="p">;}</span><span class="w"></span>
<span class="w">	    </span><span class="n">Memento</span><span class="o">*</span><span class="w"> </span><span class="n">createMemento</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w">	    </span><span class="kt">void</span><span class="w"> </span><span class="nf">reinstateMemento</span><span class="w"> </span><span class="p">(</span><span class="n">Memento</span><span class="o">*</span><span class="w"> </span><span class="n">mem</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Memento</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w"> 	    </span><span class="n">Object</span><span class="w"> </span><span class="n">object</span><span class="p">;</span><span class="w"></span>
<span class="w">  	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    	    </span><span class="n">Memento</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Object</span><span class="o">&amp;</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="o">:</span><span class="w">  </span><span class="n">object</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">    	    </span><span class="n">Object</span><span class="w"> </span><span class="n">snapshot</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">object</span><span class="p">;}</span><span class="w">  </span><span class="c1">// want a snapshot of Object itself because of its many data members</span>
<span class="p">};</span><span class="w"></span>

<span class="n">Memento</span><span class="o">*</span><span class="w"> </span><span class="nf">Object::createMemento</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Memento</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Object::reinstateMemento</span><span class="w"> </span><span class="p">(</span><span class="n">Memento</span><span class="o">*</span><span class="w"> </span><span class="n">mem</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="o">*</span><span class="k">this</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mem</span><span class="o">-&gt;</span><span class="n">snapshot</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Command</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	    </span><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="n">Object</span><span class="o">::*</span><span class="n">Action</span><span class="p">)();</span><span class="w"></span>
<span class="w">	    </span><span class="n">Object</span><span class="o">*</span><span class="w"> </span><span class="n">receiver</span><span class="p">;</span><span class="w"></span>
<span class="w">	    </span><span class="n">Action</span><span class="w"> </span><span class="n">action</span><span class="p">;</span><span class="w"></span>
<span class="w">	    </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Command</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">commandList</span><span class="p">;</span><span class="w"></span>
<span class="w">	    </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Memento</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">mementoList</span><span class="p">;</span><span class="w"></span>
<span class="w">	    </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">numCommands</span><span class="p">;</span><span class="w"></span>
<span class="w">	    </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">maxCommands</span><span class="p">;</span><span class="w"></span>
<span class="w">  	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">	    </span><span class="n">Command</span><span class="w"> </span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="o">*</span><span class="n">newReceiver</span><span class="p">,</span><span class="w"> </span><span class="n">Action</span><span class="w"> </span><span class="n">newAction</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">receiver</span><span class="w"> </span><span class="p">(</span><span class="n">newReceiver</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="p">(</span><span class="n">newAction</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">	    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">execute</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	    	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mementoList</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numCommands</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">	    		</span><span class="n">mementoList</span><span class="p">.</span><span class="n">resize</span><span class="w"> </span><span class="p">(</span><span class="n">numCommands</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">	        </span><span class="n">mementoList</span><span class="p">[</span><span class="n">numCommands</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receiver</span><span class="o">-&gt;</span><span class="n">createMemento</span><span class="p">();</span><span class="w">  </span><span class="c1">// saves the last value</span>
<span class="w">	    	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">commandList</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numCommands</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">	    		</span><span class="n">commandList</span><span class="p">.</span><span class="n">resize</span><span class="w"> </span><span class="p">(</span><span class="n">numCommands</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">	        </span><span class="n">commandList</span><span class="p">[</span><span class="n">numCommands</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span><span class="w">  </span><span class="c1">// saves the last command</span>
<span class="w">	        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">numCommands</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxCommands</span><span class="p">)</span><span class="w"></span>
<span class="w">	          	</span><span class="n">maxCommands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numCommands</span><span class="p">;</span><span class="w"></span>
<span class="w">	        </span><span class="n">numCommands</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	        </span><span class="p">(</span><span class="n">receiver</span><span class="o">-&gt;*</span><span class="n">action</span><span class="p">)();</span><span class="w"></span>
<span class="w">	    </span><span class="p">}</span><span class="w"></span>
<span class="w">	    </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">undo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">numCommands</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">	        </span><span class="p">{</span><span class="w"></span>
<span class="w">	            </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;There is nothing to undo at this point.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	            </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">	        </span><span class="p">}</span><span class="w"></span>
<span class="w">	        </span><span class="n">commandList</span><span class="p">[</span><span class="n">numCommands</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">receiver</span><span class="o">-&gt;</span><span class="n">reinstateMemento</span><span class="w"> </span><span class="p">(</span><span class="n">mementoList</span><span class="p">[</span><span class="n">numCommands</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w">	        </span><span class="n">numCommands</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
<span class="w">	    </span><span class="p">}</span><span class="w"></span>
<span class="w">	    </span><span class="kt">void</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">redo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">numCommands</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxCommands</span><span class="p">)</span><span class="w"></span>
<span class="w">	        </span><span class="p">{</span><span class="w"></span>
<span class="w">	            </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;There is nothing to redo at this point.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	            </span><span class="k">return</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">	        </span><span class="p">}</span><span class="w"></span>
<span class="w">	        </span><span class="n">Command</span><span class="o">*</span><span class="w"> </span><span class="n">commandRedo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">commandList</span><span class="p">[</span><span class="n">numCommands</span><span class="p">];</span><span class="w"></span>
<span class="w">	        </span><span class="p">(</span><span class="n">commandRedo</span><span class="o">-&gt;</span><span class="n">receiver</span><span class="o">-&gt;*</span><span class="p">(</span><span class="n">commandRedo</span><span class="o">-&gt;</span><span class="n">action</span><span class="p">))();</span><span class="w"></span>
<span class="w">	        </span><span class="n">numCommands</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Command</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">Command</span><span class="o">::</span><span class="n">commandList</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Memento</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">Command</span><span class="o">::</span><span class="n">mementoList</span><span class="p">;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">Command</span><span class="o">::</span><span class="n">numCommands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">Command</span><span class="o">::</span><span class="n">maxCommands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Please enter an integer: &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">Object</span><span class="w"> </span><span class="o">*</span><span class="n">object</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="n">Command</span><span class="w"> </span><span class="o">*</span><span class="n">commands</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="w"></span>
<span class="w">	</span><span class="n">commands</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Command</span><span class="p">(</span><span class="n">object</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">Object</span><span class="o">::</span><span class="n">doubleValue</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">commands</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Command</span><span class="p">(</span><span class="n">object</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">Object</span><span class="o">::</span><span class="n">increaseByOne</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;0.Exit,  1.Double,  2.Increase by one,  3.Undo,  4.Redo: &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">		  	</span><span class="n">Command</span><span class="o">::</span><span class="n">undo</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="w">		  	</span><span class="n">Command</span><span class="o">::</span><span class="n">redo</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">		  	</span><span class="n">commands</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">execute</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="k">else</span><span class="w"></span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Enter a proper choice: &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">			</span><span class="k">continue</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;   &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">object</span><span class="o">-&gt;</span><span class="n">getValue</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">object</span><span class="o">-&gt;</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">object</span><span class="o">-&gt;</span><span class="n">getDecimal</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;0.Exit,  1.Double,  2.Increase by one,  3.Undo,  4.Redo: &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Observer">Observer</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-8" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-8" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The Observer Pattern defines a one-to-many dependency between objects so that when one object changes state, all its dependents are notified and updated automatically.
</p>
<dl><dt>Problem</dt>
<dd>In one place or many places in the application we need to be aware about a system event or an application state change. We'd like to have a standard way of subscribing to listening for system events and a standard way of notifying the interested parties. The notification should be automated after an interested party subscribed to the system event or application state change. There also should be a way to unsubscribe.</dd></dl>
<dl><dt>Forces</dt>
<dd>Observers and observables probably should be represented by objects. The observer objects will be notified by the observable objects.</dd></dl>
<dl><dt>Solution</dt>
<dd>After subscribing the listening objects will be notified by a way of method call.</dd></dl>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;list&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;algorithm&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="c1">// The Abstract Observer</span>
<span class="k">class</span> <span class="nc">ObserverBoardInterface</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="kt">float</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// Abstract Interface for Displays</span>
<span class="k">class</span> <span class="nc">DisplayBoardInterface</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">show</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// The Abstract Subject</span>
<span class="k">class</span> <span class="nc">WeatherDataInterface</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">registerOb</span><span class="p">(</span><span class="n">ObserverBoardInterface</span><span class="o">*</span><span class="w"> </span><span class="n">ob</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">removeOb</span><span class="p">(</span><span class="n">ObserverBoardInterface</span><span class="o">*</span><span class="w"> </span><span class="n">ob</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">notifyOb</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// The Concrete Subject</span>
<span class="k">class</span> <span class="nc">ParaWeatherData</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">WeatherDataInterface</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">SensorDataChange</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="kt">float</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="kt">float</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_humidity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_pressure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">notifyOb</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">registerOb</span><span class="p">(</span><span class="n">ObserverBoardInterface</span><span class="o">*</span><span class="w"> </span><span class="n">ob</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_obs</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ob</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">removeOb</span><span class="p">(</span><span class="n">ObserverBoardInterface</span><span class="o">*</span><span class="w"> </span><span class="n">ob</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_obs</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ob</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="k">protected</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">notifyOb</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">list</span><span class="o">&lt;</span><span class="n">ObserverBoardInterface</span><span class="o">*&gt;::</span><span class="n">iterator</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_obs</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">pos</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">m_obs</span><span class="p">.</span><span class="n">end</span><span class="p">())</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="p">((</span><span class="n">ObserverBoardInterface</span><span class="o">*</span><span class="w"> </span><span class="p">)(</span><span class="o">*</span><span class="n">pos</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">m_humidity</span><span class="p">,</span><span class="n">m_temperature</span><span class="p">,</span><span class="n">m_pressure</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">DisplayBoardInterface</span><span class="o">*&gt;</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">show</span><span class="p">();</span><span class="w"></span>
<span class="w">            </span><span class="o">++</span><span class="n">pos</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">        </span><span class="n">m_humidity</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">        </span><span class="n">m_temperature</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">        </span><span class="n">m_pressure</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">list</span><span class="o">&lt;</span><span class="n">ObserverBoardInterface</span><span class="o">*</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_obs</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// A Concrete Observer</span>
<span class="k">class</span> <span class="nc">CurrentConditionBoard</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">ObserverBoardInterface</span><span class="p">,</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">DisplayBoardInterface</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">CurrentConditionBoard</span><span class="p">(</span><span class="n">ParaWeatherData</span><span class="o">&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="o">:</span><span class="n">m_data</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_data</span><span class="p">.</span><span class="n">registerOb</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">show</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;_____CurrentConditionBoard_____&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;humidity: &quot;</span><span class="o">&lt;&lt;</span><span class="n">m_h</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;temperature: &quot;</span><span class="o">&lt;&lt;</span><span class="n">m_t</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;pressure: &quot;</span><span class="o">&lt;&lt;</span><span class="n">m_p</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;_______________________________&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">m_h</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">m_t</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">m_p</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">ParaWeatherData</span><span class="o">&amp;</span><span class="w"> </span><span class="n">m_data</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// A Concrete Observer</span>
<span class="k">class</span> <span class="nc">StatisticBoard</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">ObserverBoardInterface</span><span class="p">,</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">DisplayBoardInterface</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">StatisticBoard</span><span class="p">(</span><span class="n">ParaWeatherData</span><span class="o">&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="o">:</span><span class="n">m_maxt</span><span class="p">(</span><span class="mi">-1000</span><span class="p">),</span><span class="n">m_mint</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="n">m_avet</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">m_count</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">m_data</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m_data</span><span class="p">.</span><span class="n">registerOb</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">show</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;________StatisticBoard_________&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;lowest  temperature: &quot;</span><span class="o">&lt;&lt;</span><span class="n">m_mint</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;highest temperature: &quot;</span><span class="o">&lt;&lt;</span><span class="n">m_maxt</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;average temperature: &quot;</span><span class="o">&lt;&lt;</span><span class="n">m_avet</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;_______________________________&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="o">++</span><span class="n">m_count</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="o">&gt;</span><span class="n">m_maxt</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">m_maxt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="o">&lt;</span><span class="n">m_mint</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">m_mint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">m_avet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">m_avet</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">m_count</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">m_count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">m_maxt</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">  </span><span class="n">m_mint</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">m_avet</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m_count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">ParaWeatherData</span><span class="o">&amp;</span><span class="w"> </span><span class="n">m_data</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>


<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span>
<span class="w">    </span><span class="n">ParaWeatherData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">wdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ParaWeatherData</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">CurrentConditionBoard</span><span class="o">*</span><span class="w"> </span><span class="n">currentB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CurrentConditionBoard</span><span class="p">(</span><span class="o">*</span><span class="n">wdata</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">StatisticBoard</span><span class="o">*</span><span class="w"> </span><span class="n">statisticB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StatisticBoard</span><span class="p">(</span><span class="o">*</span><span class="n">wdata</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">wdata</span><span class="o">-&gt;</span><span class="n">SensorDataChange</span><span class="p">(</span><span class="mf">10.2</span><span class="p">,</span><span class="w"> </span><span class="mf">28.2</span><span class="p">,</span><span class="w"> </span><span class="mi">1001</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">wdata</span><span class="o">-&gt;</span><span class="n">SensorDataChange</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mf">30.12</span><span class="p">,</span><span class="w"> </span><span class="mi">1003</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">wdata</span><span class="o">-&gt;</span><span class="n">SensorDataChange</span><span class="p">(</span><span class="mf">10.2</span><span class="p">,</span><span class="w"> </span><span class="mi">26</span><span class="p">,</span><span class="w"> </span><span class="mi">806</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">wdata</span><span class="o">-&gt;</span><span class="n">SensorDataChange</span><span class="p">(</span><span class="mf">10.3</span><span class="p">,</span><span class="w"> </span><span class="mf">35.9</span><span class="p">,</span><span class="w"> </span><span class="mi">900</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">wdata</span><span class="o">-&gt;</span><span class="n">removeOb</span><span class="p">(</span><span class="n">currentB</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">wdata</span><span class="o">-&gt;</span><span class="n">SensorDataChange</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">1900</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span>
<span class="w">    </span><span class="k">delete</span><span class="w"> </span><span class="n">statisticB</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">delete</span><span class="w"> </span><span class="n">currentB</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">delete</span><span class="w"> </span><span class="n">wdata</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="State">State</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-9" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-9" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The State Pattern allows an object to alter its behavior when its internal state changes. The object will appear as having changed its class.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdlib&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ctime&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span><span class="cp"></span>

<span class="k">enum</span> <span class="nc">Input</span><span class="w"> </span><span class="p">{</span><span class="n">DUCK_DOWN</span><span class="p">,</span><span class="w"> </span><span class="n">STAND_UP</span><span class="p">,</span><span class="w"> </span><span class="n">JUMP</span><span class="p">,</span><span class="w"> </span><span class="n">DIVE</span><span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Fighter</span><span class="p">;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">StandingState</span><span class="p">;</span><span class="w">  </span><span class="k">class</span> <span class="nc">JumpingState</span><span class="p">;</span><span class="w">  </span><span class="k">class</span> <span class="nc">DivingState</span><span class="p">;</span><span class="w"></span>

<span class="k">class</span> <span class="nc">FighterState</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">StandingState</span><span class="o">&gt;</span><span class="w"> </span><span class="n">standing</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">DivingState</span><span class="o">&gt;</span><span class="w"> </span><span class="n">diving</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">FighterState</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">handleInput</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">Input</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">update</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">DuckingState</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">FighterState</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">chargingTime</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">FullRestTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="n">DuckingState</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">chargingTime</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">handleInput</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">Input</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">update</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">StandingState</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">FighterState</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">handleInput</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">Input</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">update</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">JumpingState</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">FighterState</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">jumpingHeight</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="n">JumpingState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">jumpingHeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;}</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">handleInput</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">Input</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">update</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">DivingState</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">FighterState</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">handleInput</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">Input</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">update</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">StandingState</span><span class="o">&gt;</span><span class="w"> </span><span class="n">FighterState</span><span class="o">::</span><span class="n">standing</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">StandingState</span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">DivingState</span><span class="o">&gt;</span><span class="w"> </span><span class="n">FighterState</span><span class="o">::</span><span class="n">diving</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">DivingState</span><span class="p">);</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Fighter</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">FighterState</span><span class="o">&gt;</span><span class="w"> </span><span class="n">state</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">fatigueLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="n">Fighter</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">newName</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">(</span><span class="n">newName</span><span class="p">),</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="p">(</span><span class="n">FighterState</span><span class="o">::</span><span class="n">standing</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;}</span><span class="w"></span>
<span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">getFatigueLevel</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">fatigueLevel</span><span class="p">;}</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">handleInput</span><span class="w"> </span><span class="p">(</span><span class="n">Input</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">state</span><span class="o">-&gt;</span><span class="n">handleInput</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="p">);}</span><span class="w">  </span><span class="c1">// delegate input handling to &#39;state&#39;.</span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">changeState</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">FighterState</span><span class="o">&gt;</span><span class="w"> </span><span class="n">newState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newState</span><span class="p">;</span><span class="w">  </span><span class="n">updateWithNewState</span><span class="p">();}</span><span class="w"></span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">standsUp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; stands up.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;}</span><span class="w"></span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">ducksDown</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; ducks down.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;}</span><span class="w"></span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">jumps</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; jumps into the air.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;}</span><span class="w"></span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">dives</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; makes a dive attack in the middle of the jump!&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;}</span><span class="w"></span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">feelsStrong</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; feels strong!&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;}</span><span class="w"></span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">changeFatigueLevelBy</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">change</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">fatigueLevel</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">change</span><span class="p">;</span><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;fatigueLevel = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fatigueLevel</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;}</span><span class="w"></span>
<span class="w">	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">updateWithNewState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="n">state</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);}</span><span class="w">  </span><span class="c1">// delegate updating to &#39;state&#39;</span>
<span class="p">};</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">StandingState::handleInput</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="w"> </span><span class="n">fighter</span><span class="p">,</span><span class="w"> </span><span class="n">Input</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="nl">STAND_UP</span><span class="p">:</span><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; remains standing.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w">  </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="nl">DUCK_DOWN</span><span class="p">:</span><span class="w">  </span><span class="n">fighter</span><span class="p">.</span><span class="n">changeState</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">DuckingState</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">DuckingState</span><span class="p">));</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">ducksDown</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="nl">JUMP</span><span class="p">:</span><span class="w">  </span><span class="n">fighter</span><span class="p">.</span><span class="n">jumps</span><span class="p">();</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">changeState</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">JumpingState</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JumpingState</span><span class="p">));</span><span class="w"></span>
<span class="w">		</span><span class="k">default</span><span class="o">:</span><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;One cannot do that while standing.  &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; remains standing by default.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">StandingState::update</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="w"> </span><span class="n">fighter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fighter</span><span class="p">.</span><span class="n">getFatigueLevel</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">fighter</span><span class="p">.</span><span class="n">changeFatigueLevelBy</span><span class="p">(</span><span class="mi">-1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">DuckingState::handleInput</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="w"> </span><span class="n">fighter</span><span class="p">,</span><span class="w"> </span><span class="n">Input</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="nl">STAND_UP</span><span class="p">:</span><span class="w">  </span><span class="n">fighter</span><span class="p">.</span><span class="n">changeState</span><span class="w"> </span><span class="p">(</span><span class="n">FighterState</span><span class="o">::</span><span class="n">standing</span><span class="p">);</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">standsUp</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="nl">DUCK_DOWN</span><span class="p">:</span><span class="w"></span>
<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; remains in ducking position, &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">chargingTime</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">FullRestTime</span><span class="p">)</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;recovering in the meantime.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">			</span><span class="k">else</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;fully recovered.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="p">(</span><span class="n">fighter</span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="k">default</span><span class="o">:</span><span class="w"></span>
<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;One cannot do that while ducking.  &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; remains in ducking position by default.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">			</span><span class="n">update</span><span class="w"> </span><span class="p">(</span><span class="n">fighter</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">DuckingState::update</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="w"> </span><span class="n">fighter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">chargingTime</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Charging time = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">chargingTime</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fighter</span><span class="p">.</span><span class="n">getFatigueLevel</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">fighter</span><span class="p">.</span><span class="n">changeFatigueLevelBy</span><span class="p">(</span><span class="mi">-1</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">chargingTime</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">FullRestTime</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">getFatigueLevel</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">fighter</span><span class="p">.</span><span class="n">feelsStrong</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">JumpingState::handleInput</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="w"> </span><span class="n">fighter</span><span class="p">,</span><span class="w"> </span><span class="n">Input</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="nl">DIVE</span><span class="p">:</span><span class="w">  </span><span class="n">fighter</span><span class="p">.</span><span class="n">changeState</span><span class="w"> </span><span class="p">(</span><span class="n">FighterState</span><span class="o">::</span><span class="n">diving</span><span class="p">);</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">dives</span><span class="p">();</span><span class="w"></span>
<span class="w">		</span><span class="k">default</span><span class="o">:</span><span class="w"></span>
<span class="w">			</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;One cannot do that in the middle of a jump.  &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; lands from his jump and is now standing again.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">			</span><span class="n">fighter</span><span class="p">.</span><span class="n">changeState</span><span class="w"> </span><span class="p">(</span><span class="n">FighterState</span><span class="o">::</span><span class="n">standing</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">JumpingState::update</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="w"> </span><span class="n">fighter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; has jumped &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">jumpingHeight</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; feet into the air.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jumpingHeight</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">fighter</span><span class="p">.</span><span class="n">changeFatigueLevelBy</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">DivingState::handleInput</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="w"> </span><span class="n">fighter</span><span class="p">,</span><span class="w"> </span><span class="n">Input</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Regardless of what the user input is, &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; lands from his dive and is now standing again.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">fighter</span><span class="p">.</span><span class="n">changeState</span><span class="w"> </span><span class="p">(</span><span class="n">FighterState</span><span class="o">::</span><span class="n">standing</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">DivingState::update</span><span class="w"> </span><span class="p">(</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="w"> </span><span class="n">fighter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">fighter</span><span class="p">.</span><span class="n">changeFatigueLevelBy</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">srand</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">time</span><span class="p">(</span><span class="k">nullptr</span><span class="p">));</span><span class="w"></span>
<span class="w">	</span><span class="n">Fighter</span><span class="w"> </span><span class="n">rex</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Rex the Fighter&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">borg</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Borg the Fighter&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">rex</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; and &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">borg</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; are currently standing.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">choice</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">auto</span><span class="w"> </span><span class="n">chooseAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">choice</span><span class="p">](</span><span class="n">Fighter</span><span class="o">&amp;</span><span class="w"> </span><span class="n">fighter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">DUCK_DOWN</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;) Duck down  &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">STAND_UP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;) Stand up  &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">JUMP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">			</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;) Jump  &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">DIVE</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;) Dive in the middle of a jump&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Choice for &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fighter</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;? &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">choice</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="n">Input</span><span class="w"> </span><span class="n">input1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Input</span><span class="o">&gt;</span><span class="p">(</span><span class="n">choice</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="n">fighter</span><span class="p">.</span><span class="n">handleInput</span><span class="w"> </span><span class="p">(</span><span class="n">input1</span><span class="p">);</span><span class="w">	</span>
<span class="w">	</span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="n">chooseAction</span><span class="w"> </span><span class="p">(</span><span class="n">rex</span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="n">chooseAction</span><span class="w"> </span><span class="p">(</span><span class="n">borg</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Strategy">Strategy</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-10" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-10" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Defines a family of algorithms, encapsulates each one, and make them interchangeable. Strategy lets the algorithm vary independently from clients who use it.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>

<span class="k">class</span> <span class="nc">StrategyInterface</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">execute</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">ConcreteStrategyA</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">StrategyInterface</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="n">execute</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Called ConcreteStrategyA execute method&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">ConcreteStrategyB</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">StrategyInterface</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="n">execute</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Called ConcreteStrategyB execute method&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">ConcreteStrategyC</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">StrategyInterface</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="n">execute</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Called ConcreteStrategyC execute method&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Context</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">StrategyInterface</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">strategy_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="k">explicit</span><span class="w"> </span><span class="n">Context</span><span class="p">(</span><span class="n">StrategyInterface</span><span class="w"> </span><span class="o">*</span><span class="n">strategy</span><span class="p">)</span><span class="o">:</span><span class="n">strategy_</span><span class="p">(</span><span class="n">strategy</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="n">set_strategy</span><span class="p">(</span><span class="n">StrategyInterface</span><span class="w"> </span><span class="o">*</span><span class="n">strategy</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">strategy_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strategy</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="n">execute</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">strategy_</span><span class="o">-&gt;</span><span class="n">execute</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">ConcreteStrategyA</span><span class="w"> </span><span class="n">concreteStrategyA</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">ConcreteStrategyB</span><span class="w"> </span><span class="n">concreteStrategyB</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">ConcreteStrategyC</span><span class="w"> </span><span class="n">concreteStrategyC</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">Context</span><span class="w"> </span><span class="n">contextA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">concreteStrategyA</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Context</span><span class="w"> </span><span class="n">contextB</span><span class="p">(</span><span class="o">&amp;</span><span class="n">concreteStrategyB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Context</span><span class="w"> </span><span class="n">contextC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">concreteStrategyC</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">contextA</span><span class="p">.</span><span class="n">execute</span><span class="p">();</span><span class="w"> </span><span class="c1">// output: &quot;Called ConcreteStrategyA execute method&quot;</span>
<span class="w">    </span><span class="n">contextB</span><span class="p">.</span><span class="n">execute</span><span class="p">();</span><span class="w"> </span><span class="c1">// output: &quot;Called ConcreteStrategyB execute method&quot;</span>
<span class="w">    </span><span class="n">contextC</span><span class="p">.</span><span class="n">execute</span><span class="p">();</span><span class="w"> </span><span class="c1">// output: &quot;Called ConcreteStrategyC execute method&quot;</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">contextA</span><span class="p">.</span><span class="n">set_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">concreteStrategyB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">contextA</span><span class="p">.</span><span class="n">execute</span><span class="p">();</span><span class="w"> </span><span class="c1">// output: &quot;Called ConcreteStrategyB execute method&quot;</span>
<span class="w">    </span><span class="n">contextA</span><span class="p">.</span><span class="n">set_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">concreteStrategyC</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">contextA</span><span class="p">.</span><span class="n">execute</span><span class="p">();</span><span class="w"> </span><span class="c1">// output: &quot;Called ConcreteStrategyC execute method&quot;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Template_Method">Template Method</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-11" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-11" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>By defining a skeleton of an algorithm in an operation, deferring some steps to subclasses, the Template Method lets subclasses redefine certain steps of that algorithm without changing the algorithm's structure.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ctime&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;assert.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">wikibooks_design_patterns</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="cm">/**</span>
<span class="cm"> * An abstract class that is common to several games in</span>
<span class="cm"> * which players play against the others, but only one is</span>
<span class="cm"> * playing at a given time.</span>
<span class="cm"> */</span><span class="w"></span>

<span class="k">class</span> <span class="nc">Game</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">Game</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="n">playersCount</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">movesCount</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">playerWon</span><span class="p">(</span><span class="mi">-1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">srand</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span><span class="w"> </span><span class="nb">NULL</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="cm">/* A template method&#160;: */</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">playOneGame</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">playersCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">playersCount</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">playersCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">playersCount</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="n">InitializeGame</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">assert</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">playersCount</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">endOfGame</span><span class="p">())</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">makePlay</span><span class="p">(</span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">playersCount</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="o">++</span><span class="n">movesCount</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">printWinner</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="k">protected</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">initializeGame</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">makePlay</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">endOfGame</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">printWinner</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">InitializeGame</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">movesCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">playerWon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="n">initializeGame</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="k">protected</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">playersCount</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">movesCount</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">playerWon</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="c1">//Now we can extend this class in order </span>
<span class="c1">//to implement actual games:</span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Monopoly</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Game</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span>
<span class="w">    </span><span class="cm">/* Implementation of necessary concrete methods */</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">initializeGame</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Initialize players</span>
<span class="w">	</span><span class="n">playersCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">RAND_MAX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Initialize money</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">makePlay</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Process one turn of player</span>

<span class="w">	</span><span class="c1">//	Decide winner</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">movesCount</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"></span>
<span class="w">	    </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">chances</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">movesCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">199</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">199</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">movesCount</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MOVES_WIN_CORRECTION</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">RAND_MAX</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">random</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">chances</span><span class="p">)</span><span class="w"></span>
<span class="w">	    </span><span class="n">playerWon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">endOfGame</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Return true if game is over </span>
<span class="w">        </span><span class="c1">// according to Monopoly rules</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mi">-1</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">playerWon</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">printWinner</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">assert</span><span class="p">(</span><span class="n">playerWon</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">assert</span><span class="p">(</span><span class="n">playerWon</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">playersCount</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Display who won</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;Monopoly, player &quot;</span><span class="o">&lt;&lt;</span><span class="n">playerWon</span><span class="o">&lt;&lt;</span><span class="s">&quot; won in &quot;</span><span class="o">&lt;&lt;</span><span class="n">movesCount</span><span class="o">&lt;&lt;</span><span class="s">&quot; moves.&quot;</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="k">enum</span>
    <span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">MOVES_WIN_CORRECTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Chess</span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Game</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span>
<span class="w">    </span><span class="cm">/* Implementation of necessary concrete methods */</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">initializeGame</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Initialize players</span>
<span class="w">	</span><span class="n">playersCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Put the pieces on the board</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">makePlay</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">assert</span><span class="p">(</span><span class="n">player</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">playersCount</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Process a turn for the player</span>

<span class="w">	</span><span class="c1">//	decide winner</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">movesCount</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">	    </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">chances</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">movesCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">99</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">99</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">movesCount</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MOVES_WIN_CORRECTION</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">RAND_MAX</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//std::cout&lt;&lt;random&lt;&lt;&quot;&#160;: &quot;&lt;&lt;chances&lt;&lt;std::endl;</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">random</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">chances</span><span class="p">)</span><span class="w"></span>
<span class="w">	    </span><span class="n">playerWon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">endOfGame</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Return true if in Checkmate or </span>
<span class="w">        </span><span class="c1">// Stalemate has been reached</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mi">-1</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">playerWon</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">printWinner</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">assert</span><span class="p">(</span><span class="n">playerWon</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">assert</span><span class="p">(</span><span class="n">playerWon</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">playersCount</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Display the winning player</span>
<span class="w">	</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;Player &quot;</span><span class="o">&lt;&lt;</span><span class="n">playerWon</span><span class="o">&lt;&lt;</span><span class="s">&quot; won in &quot;</span><span class="o">&lt;&lt;</span><span class="n">movesCount</span><span class="o">&lt;&lt;</span><span class="s">&quot; moves.&quot;</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="k">enum</span>
    <span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">MOVES_WIN_CORRECTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">wikibooks_design_patterns</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">Game</span><span class="o">*</span><span class="w"> </span><span class="n">game</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">Chess</span><span class="w"> </span><span class="n">chess</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">game</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">chess</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">	 </span><span class="n">game</span><span class="o">-&gt;</span><span class="n">playOneGame</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">Monopoly</span><span class="w"> </span><span class="n">monopoly</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">game</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">monopoly</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="n">game</span><span class="o">-&gt;</span><span class="n">playOneGame</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span class="mw-headline" id="Visitor">Visitor</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-12" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-12" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The Visitor Pattern will represent an operation to be performed on the elements of an object structure by letting you define a new operation without changing the classes of the elements on which it operates.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span><span class="cp"></span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Wheel</span><span class="p">;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">Engine</span><span class="p">;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">Body</span><span class="p">;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">Car</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span>
<span class="c1">// interface to all car &#39;parts&#39;</span>
<span class="k">struct</span> <span class="nc">CarElementVisitor</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">visit</span><span class="p">(</span><span class="n">Wheel</span><span class="o">&amp;</span><span class="w"> </span><span class="n">wheel</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">visit</span><span class="p">(</span><span class="n">Engine</span><span class="o">&amp;</span><span class="w"> </span><span class="n">engine</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">visit</span><span class="p">(</span><span class="n">Body</span><span class="o">&amp;</span><span class="w"> </span><span class="n">body</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">visitCar</span><span class="p">(</span><span class="n">Car</span><span class="o">&amp;</span><span class="w"> </span><span class="n">car</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="c1">// interface to one part</span>
<span class="k">struct</span> <span class="nc">CarElement</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">accept</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CarElementVisitor</span><span class="o">&amp;</span><span class="w"> </span><span class="n">visitor</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">	</span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="c1">// wheel element, there are four wheels with unique names</span>
<span class="k">class</span> <span class="nc">Wheel</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">CarElement</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="k">explicit</span><span class="w"> </span><span class="n">Wheel</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">name_</span><span class="p">(</span><span class="n">name</span><span class="p">){}</span><span class="w"></span>

<span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">name_</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>

<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">accept</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CarElementVisitor</span><span class="o">&amp;</span><span class="w"> </span><span class="n">visitor</span><span class="p">)</span><span class="w">  </span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">visitor</span><span class="p">.</span><span class="n">visit</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">	    </span><span class="n">string</span><span class="w"> </span><span class="n">name_</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Engine</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">CarElement</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">accept</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CarElementVisitor</span><span class="o">&amp;</span><span class="w"> </span><span class="n">visitor</span><span class="p">)</span><span class="w"> </span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">visitor</span><span class="p">.</span><span class="n">visit</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Body</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">CarElement</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">accept</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CarElementVisitor</span><span class="o">&amp;</span><span class="w"> </span><span class="n">visitor</span><span class="p">)</span><span class="w"> </span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">visitor</span><span class="p">.</span><span class="n">visit</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="w"> </span>
<span class="k">class</span> <span class="nc">Car</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">CarElement</span><span class="o">&gt;&gt;&amp;</span><span class="w"> </span><span class="n">getElements</span><span class="p">()</span><span class="w"></span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">elements_</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="w">		</span>
<span class="w">		</span><span class="n">Car</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="c1">// assume that neither push_back nor Wheel(const string&amp;) may throw</span>
<span class="w">			</span><span class="n">elements_</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Wheel</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;front left&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">			</span><span class="n">elements_</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Wheel</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;front right&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">			</span><span class="n">elements_</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Wheel</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;back left&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">			</span><span class="n">elements_</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Wheel</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;back right&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">			</span><span class="n">elements_</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Body</span><span class="o">&gt;</span><span class="p">()</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">			</span><span class="n">elements_</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">Engine</span><span class="o">&gt;</span><span class="p">()</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">CarElement</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">elements_</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>


<span class="c1">// PrintVisitor and DoVisitor show by using a different implementation the Car class is unchanged even though the algorithm is different in PrintVisitor and DoVisitor.</span>

<span class="k">class</span> <span class="nc">CarElementPrintVisitor</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">CarElementVisitor</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">visit</span><span class="p">(</span><span class="n">Wheel</span><span class="o">&amp;</span><span class="w"> </span><span class="n">wheel</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">		</span><span class="p">{</span><span class="w"> </span>
<span class="w">			</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Visiting &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">wheel</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; wheel&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">visit</span><span class="p">(</span><span class="n">Engine</span><span class="o">&amp;</span><span class="w"> </span><span class="n">engine</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Visiting engine&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>

<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">visit</span><span class="p">(</span><span class="n">Body</span><span class="o">&amp;</span><span class="w"> </span><span class="n">body</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Visiting body&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>

<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">visitCar</span><span class="p">(</span><span class="n">Car</span><span class="o">&amp;</span><span class="w"> </span><span class="n">car</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Visiting car&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">			</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">CarElement</span><span class="o">&gt;&gt;&amp;</span><span class="w"> </span><span class="n">elems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">car</span><span class="p">.</span><span class="n">getElements</span><span class="p">();</span><span class="w"></span>
<span class="w">			</span>
<span class="w">			</span><span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="nl">it</span> <span class="p">:</span><span class="w"> </span><span class="n">elems</span><span class="p">)</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="c1">// this issues the callback i.e. to this from the element</span>
<span class="w">				</span><span class="n">it</span><span class="o">-&gt;</span><span class="n">accept</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w">	  </span>
<span class="w">			</span><span class="p">}</span><span class="w"></span>
<span class="w">			</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Visited car&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">CarElementDoVisitor</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">CarElementVisitor</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">		</span><span class="c1">// these are specific implementations added to the original object without modifying the original struct</span>
<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">visit</span><span class="p">(</span><span class="n">Wheel</span><span class="o">&amp;</span><span class="w"> </span><span class="n">wheel</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Kicking my &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">wheel</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; wheel&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>

<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">visit</span><span class="p">(</span><span class="n">Engine</span><span class="o">&amp;</span><span class="w"> </span><span class="n">engine</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Starting my engine&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>

<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">visit</span><span class="p">(</span><span class="n">Body</span><span class="o">&amp;</span><span class="w"> </span><span class="n">body</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Moving my body&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>

<span class="w">		</span><span class="kt">void</span><span class="w"> </span><span class="n">visitCar</span><span class="p">(</span><span class="n">Car</span><span class="o">&amp;</span><span class="w"> </span><span class="n">car</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="w">		</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Starting my car&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">			</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">CarElement</span><span class="o">&gt;&gt;&amp;</span><span class="w"> </span><span class="n">elems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">car</span><span class="p">.</span><span class="n">getElements</span><span class="p">();</span><span class="w"></span>

<span class="w">			</span><span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="nl">it</span> <span class="p">:</span><span class="w"> </span><span class="n">elems</span><span class="p">)</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="n">it</span><span class="o">-&gt;</span><span class="n">accept</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w">	</span><span class="c1">// this issues the callback i.e. to this from the element  </span>
<span class="w">			</span><span class="p">}</span><span class="w"></span>
<span class="w">			</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Stopped car&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="n">Car</span><span class="w"> </span><span class="n">car</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">CarElementPrintVisitor</span><span class="w"> </span><span class="n">printVisitor</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">CarElementDoVisitor</span><span class="w"> </span><span class="n">doVisitor</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="n">printVisitor</span><span class="p">.</span><span class="n">visitCar</span><span class="p">(</span><span class="n">car</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">doVisitor</span><span class="p">.</span><span class="n">visitCar</span><span class="p">(</span><span class="n">car</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
<h3><span id="Model-View-Controller_.28MVC.29"></span><span class="mw-headline" id="Model-View-Controller_(MVC)">Model-View-Controller (MVC)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;veaction=edit&amp;section=T-13" class="mw-editsection-visualeditor" title="Edit section: ">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns/Behavioral_Patterns&amp;action=edit&amp;section=T-13" title="Edit section: ">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>A pattern often used by applications that need the ability to maintain multiple views of the same data. The model-view-controller pattern was until recently<sup class="Template-Fact" style="white-space:nowrap;">&#91;<i><a href="/wiki/Wikibooks:OR" class="mw-redirect" title="Wikibooks:OR"><span title="This claim needs references to reliable sources">citation needed</span></a></i>&#93;</sup> a very common pattern especially for graphic user interlace programming, it splits the code in 3 pieces. The model, the view, and the controller. 
</p><p>The Model is the actual data representation (for example, Array vs Linked List) or other objects representing a database. The View is an interface to reading the model or a fat client GUI. The Controller provides the interface of changing or modifying the data, and then selecting the "Next Best View" (NBV). 
</p><p>Newcomers will probably see this "MVC" model as wasteful, mainly because you are working with many extra objects at runtime, when it seems like one giant object will do. But the secret to the MVC pattern is not writing the code, but in maintaining it, and allowing people to modify the code without changing much else. Also, keep in mind, that different developers have different strengths and weaknesses, so team building around MVC is easier. Imagine a View Team that is responsible for great views, a Model Team that knows a lot about data, and a Controller Team that see the big picture of application flow, handing requests, working with the model, and selecting the most appropriate next view for that client.
</p><p><br />
</p>
<table style="background: #ffd; border: 1px solid #aaaaaa; padding: 3px; margin: 5px auto; width: 60%" class="notice noprint notice-todo">
<tbody><tr>
<td style="width: 58px;"><div class="floatleft"><img alt="Clipboard" src="//upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/45px-Clipboard.svg.png" decoding="async" width="45" height="45" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/68px-Clipboard.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Clipboard.svg/90px-Clipboard.svg.png 2x" data-file-width="48" data-file-height="48" /></div>
</td>
<td>
<p><b>To do:</b><br />Erm, someone please come up with a better example than the following... I can not think of any
</p>
<ul><li>Perhaps a banking program for customer access to their accounts: A web UI on a traditional browser vs mobile app? And then handling checking/savings accounts vs loan vs line-of-credit accounts?  fwiw</li></ul>
</td></tr></tbody></table>
<p><br />
</p><p>For example: A naive central database can be organized using only a "model", for example, a straight array. However, later on, it may be more applicable to use a linked list. All array accesses will have to be remade into their respective Linked List form (for example, you would change myarray[5] into mylist.at(5) or whatever is equivalent in the language you use).
</p><p>Well, if we followed the MVC pattern, the central database would be accessed using some sort of a function, for example, myarray.at(5). If we change the model from an array to a linked list, all we have to do is change the view with the model, and the whole program is changed. Keep the interface the same but change the underpinnings of it. This would allow us to make optimizations more freely and quickly than before.
</p><p>One of the great advantages of the Model-View-Controller Pattern is obviously the ability to reuse the application's logic (which is implemented in the model) when implementing a different view. A good example is found in web development, where a common task is to implement an external API inside of an existing piece of software. If the MVC pattern has cleanly been followed, this only requires modification to the controller, which can have the ability to render different types of views dependent on the content type requested by the user agent.
<span id="displaytitle" title=""></span>
</p>
<!-- 
NewPP limit report
Parsed by mw1350
Cached time: 20220315190629
Cache expiry: 1814400
Reduced expiry: false
Complications: []
CPU time usage: 0.853 seconds
Real time usage: 9.097 seconds
Preprocessor visited node count: 1409/1000000
Postâ€expand include size: 41570/2097152 bytes
Template argument size: 4391/2097152 bytes
Highest expansion depth: 23/100
Expensive parser function count: 0/500
Unstrip recursion depth: 0/20
Unstrip postâ€expand size: 523588/5000000 bytes
Lua time usage: 0.036/10.000 seconds
Lua memory usage: 1481946/52428800 bytes
Number of Wikibase entities loaded: 0/400
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 8501.007      1 -total
 43.53% 3700.284      1 C++_Programming/Code/Design_Patterns/Behavioral_Patterns
 29.34% 2493.811      1 C++_Programming/Code/Design_Patterns/Structural_Patterns
 26.97% 2292.694      1 C++_Programming/Code/Design_Patterns/Creational_Patterns
  0.72%   61.034      4 Template:BOOKCAT
  0.52%   44.455      5 Template:Citation_needed
  0.48%   40.956      3 Template:Ifsubst
  0.43%   36.976      3 Template:Fix
  0.38%   32.604      3 Template:Cat_handler
  0.23%   19.856      4 Template:Evalx
-->

<!-- Saved in parser cache with key enwikibooks:pcache:idhash:54848-0!canonical and timestamp 20220315190620 and revision id 3520978. Serialized with JSON.
 -->
</div><noscript><img src="//en.wikibooks.org/wiki/Special:CentralAutoLogin/start?type=1x1" alt="" title="" width="1" height="1" style="border: none; position: absolute;" /></noscript>
<div class="printfooter">Retrieved from "<a dir="ltr" href="https://en.wikibooks.org/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;oldid=3520978">https://en.wikibooks.org/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;oldid=3520978</a>"</div></div>
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/wiki/Category:Book:C%2B%2B_Programming" title="Category:Book:C++ Programming">Book:C++ Programming</a></li></ul></div><div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul><li><a href="/wiki/Category:Wikibooks_pages_with_to-do_lists" title="Category:Wikibooks pages with to-do lists">Wikibooks pages with to-do lists</a></li><li><a href="/wiki/Category:Pages_needing_sources" title="Category:Pages needing sources">Pages needing sources</a></li></ul></div></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		
<nav id="p-personal" class="mw-portlet mw-portlet-personal vector-user-menu-legacy vector-menu" aria-labelledby="p-personal-label" role="navigation" 
	 >
	<label id="p-personal-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Personal tools</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-anonuserpage" class="mw-list-item"><span>Not logged in</span></li><li id="pt-anontalk" class="mw-list-item"><a href="/wiki/Special:MyTalk" title="Discussion about edits from this IP address [n]" accesskey="n"><span>Discussion for this IP address</span></a></li><li id="pt-anoncontribs" class="mw-list-item"><a href="/wiki/Special:MyContributions" title="A list of edits made from this IP address [y]" accesskey="y"><span>Contributions</span></a></li><li id="pt-createaccount" class="mw-list-item"><a href="/w/index.php?title=Special:CreateAccount&amp;returnto=C%2B%2B+Programming%2FCode%2FDesign+Patterns" title="You are encouraged to create an account and log in; however, it is not mandatory"><span>Create account</span></a></li><li id="pt-login" class="mw-list-item"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=C%2B%2B+Programming%2FCode%2FDesign+Patterns" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			
<nav id="p-namespaces" class="mw-portlet mw-portlet-namespaces vector-menu vector-menu-tabs" aria-labelledby="p-namespaces-label" role="navigation" 
	 >
	<label id="p-namespaces-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Namespaces</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected mw-list-item"><a href="/wiki/C%2B%2B_Programming/Code/Design_Patterns" title="View the content page [c]" accesskey="c"><span>Book</span></a></li><li id="ca-talk" class="mw-list-item"><a href="/wiki/Talk:C%2B%2B_Programming/Code/Design_Patterns" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li></ul>
		
	</div>
</nav>

			
<nav id="p-variants" class="mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown-noicon vector-menu vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation" 
	 >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox" aria-labelledby="p-variants-label" />
	<label id="p-variants-label" aria-label="Change language variant" class="vector-menu-heading">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			
<nav id="p-views" class="mw-portlet mw-portlet-views vector-menu vector-menu-tabs" aria-labelledby="p-views-label" role="navigation" 
	 >
	<label id="p-views-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Views</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href="/wiki/C%2B%2B_Programming/Code/Design_Patterns"><span>Read</span></a></li><li id="ca-ve-edit" class="mw-list-item"><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;veaction=edit" title="Edit this page [v]" accesskey="v"><span>Edit</span></a></li><li id="ca-edit" class="collapsible mw-list-item"><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;action=edit" title="Edit this page [e]" accesskey="e"><span>Edit source</span></a></li><li id="ca-history" class="mw-list-item"><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li></ul>
		
	</div>
</nav>

			
<nav id="p-cactions" class="mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown-noicon vector-menu vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options"
	 >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox" aria-labelledby="p-cactions-label" />
	<label id="p-cactions-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<div>
			<h3 >
				<label for="searchInput">Search</label>
			</h3>
		<form action="/w/index.php" id="searchform"
			class="vector-search-box-form">
			<div id="simpleSearch"
				class="vector-search-box-inner"
				 data-search-loc="header-navigation">
				<input class="vector-search-box-input"
					 type="search" name="search" placeholder="Search Wikibooks" aria-label="Search Wikibooks" autocapitalize="sentences" title="Search Wikibooks [f]" accesskey="f" id="searchInput"
				/>
				<input type="hidden" name="title" value="Special:Search"/>
				<input id="mw-searchButton"
					 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search" />
				<input id="searchButton"
					 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go" />
			</div>
		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="/wiki/Main_Page"
			title="Visit the main page"></a>
	</div>
	
<nav id="p-Navigation" class="mw-portlet mw-portlet-Navigation vector-menu vector-menu-portal portal" aria-labelledby="p-Navigation-label" role="navigation" 
	 >
	<label id="p-Navigation-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Navigation</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-mainpage" class="mw-list-item"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"><span>Main Page</span></a></li><li id="n-help" class="mw-list-item"><a href="/wiki/Help:Contents" icon="help" title="Find help on how to use and edit Wikibooks"><span>Help</span></a></li><li id="n-Browse" class="mw-list-item"><a href="/wiki/Wikibooks:Card_Catalog_Office" title="Check out what Wikibooks has to offer"><span>Browse</span></a></li><li id="n-Cookbook" class="mw-list-item"><a href="/wiki/Cookbook:Table_of_Contents" title="Learn recipes from around the world"><span>Cookbook</span></a></li><li id="n-Wikijunior" class="mw-list-item"><a href="/wiki/Wikijunior" title="Books for children"><span>Wikijunior</span></a></li><li id="n-Featured-books" class="mw-list-item"><a href="/wiki/Wikibooks:Featured_books" title="The best of Wikibooks"><span>Featured books</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="/wiki/Special:RecentChanges" icon="recentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li><li id="n-sitesupport" class="mw-list-item"><a href="//donate.wikimedia.org/wiki/Special:FundraiserRedirector?utm_source=donate&amp;utm_medium=sidebar&amp;utm_campaign=C13_en.wikibooks.org&amp;uselang=en" title="Support Wikibooks"><span>Donations</span></a></li><li id="n-randomrootpage" class="mw-list-item"><a href="/wiki/Special:RandomInCategory/Book:Wikibooks_Stacks/Books"><span>Random book</span></a></li><li id="n-Using-Wikibooks" class="mw-list-item"><a href="/wiki/Using_Wikibooks"><span>Using Wikibooks</span></a></li></ul>
		
	</div>
</nav>

	
<nav id="p-Community" class="mw-portlet mw-portlet-Community vector-menu vector-menu-portal portal" aria-labelledby="p-Community-label" role="navigation" 
	 >
	<label id="p-Community-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Community</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Reading-room-forum" class="mw-list-item"><a href="/wiki/Wikibooks:Reading_room"><span>Reading room forum</span></a></li><li id="n-portal" class="mw-list-item"><a href="/wiki/Wikibooks:Community_Portal" title="Find your way around the Wikibooks community"><span>Community portal</span></a></li><li id="n-currentevents" class="mw-list-item"><a href="/wiki/Wikibooks:Reading_room/Bulletin_Board" title="Important community news"><span>Bulletin Board</span></a></li><li id="n-maintenance" class="mw-list-item"><a href="/wiki/Wikibooks:Maintenance" title="Frequent tasks that you can help with"><span>Help out!</span></a></li><li id="n-Policies-and-guidelines" class="mw-list-item"><a href="/wiki/Wikibooks:Policies_and_guidelines" title="Pages detailing important rules and procedures"><span>Policies and guidelines</span></a></li><li id="n-contact" class="mw-list-item"><a href="/wiki/Wikibooks:Contact_us" title="Alternative methods of communication"><span>Contact us</span></a></li></ul>
		
	</div>
</nav>

<nav id="p-tb" class="mw-portlet mw-portlet-tb vector-menu vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation" 
	 >
	<label id="p-tb-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Tools</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="/wiki/Special:WhatLinksHere/C%2B%2B_Programming/Code/Design_Patterns" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="/wiki/Special:RecentChangesLinked/C%2B%2B_Programming/Code/Design_Patterns" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-upload" class="mw-list-item"><a href="//commons.wikimedia.org/wiki/Special:UploadWizard?uselang=en" title="Upload files [u]" accesskey="u"><span>Upload file</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-permalink" class="mw-list-item"><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;oldid=3520978" title="Permanent link to this revision of the page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;action=info" title="More information about this page"><span>Page information</span></a></li><li id="t-cite" class="mw-list-item"><a href="/w/index.php?title=Special:CiteThisPage&amp;page=C%2B%2B_Programming%2FCode%2FDesign_Patterns&amp;id=3520978&amp;wpFormIdentifier=titleform" title="Information on how to cite this page"><span>Cite this page</span></a></li></ul>
		
	</div>
</nav>

<nav id="p-Sister_projects" class="mw-portlet mw-portlet-Sister_projects vector-menu vector-menu-portal portal" aria-labelledby="p-Sister_projects-label" role="navigation" 
	 >
	<label id="p-Sister_projects-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Sister projects</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Wikipedia" class="mw-list-item"><a href="https://en.wikipedia.org/wiki/Main_Page"><span>Wikipedia</span></a></li><li id="n-Wikiversity" class="mw-list-item"><a href="https://en.wikiversity.org/wiki/Wikiversity:Main_Page"><span>Wikiversity</span></a></li><li id="n-Wiktionary" class="mw-list-item"><a href="https://en.wiktionary.org/wiki/Wiktionary:Main_Page"><span>Wiktionary</span></a></li><li id="n-Wikiquote" class="mw-list-item"><a href="https://en.wikiquote.org/wiki/Main_Page"><span>Wikiquote</span></a></li><li id="n-Wikisource" class="mw-list-item"><a href="https://en.wikisource.org/wiki/Main_Page"><span>Wikisource</span></a></li><li id="n-Wikinews" class="mw-list-item"><a href="https://en.wikinews.org/wiki/Main_Page"><span>Wikinews</span></a></li><li id="n-Wikivoyage" class="mw-list-item"><a href="https://en.wikivoyage.org/wiki/Main_Page"><span>Wikivoyage</span></a></li><li id="n-Commons" class="mw-list-item"><a href="https://commons.wikimedia.org/wiki/Main_Page"><span>Commons</span></a></li><li id="n-Wikidata" class="mw-list-item"><a href="https://www.wikidata.org/wiki/Wikidata:Main_Page"><span>Wikidata</span></a></li><li id="n-MediaWiki" class="mw-list-item"><a href="https://www.mediawiki.org/wiki/Main_Page"><span>MediaWiki</span></a></li><li id="n-Meta-Wiki" class="mw-list-item"><a href="https://meta.wikimedia.org/wiki/Main_Page"><span>Meta-Wiki</span></a></li></ul>
		
	</div>
</nav>

<nav id="p-coll-print_export" class="mw-portlet mw-portlet-coll-print_export vector-menu vector-menu-portal portal" aria-labelledby="p-coll-print_export-label" role="navigation" 
	 >
	<label id="p-coll-print_export-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">Print/export</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="coll-create_a_book" class="mw-list-item"><a href="/w/index.php?title=Special:Book&amp;bookcmd=book_creator&amp;referer=C%2B%2B+Programming%2FCode%2FDesign+Patterns"><span>Create a collection</span></a></li><li id="coll-download-as-rl" class="mw-list-item"><a href="/w/index.php?title=Special:DownloadAsPdf&amp;page=C%2B%2B_Programming%2FCode%2FDesign_Patterns&amp;action=show-download-screen"><span>Download as PDF</span></a></li><li id="t-print" class="mw-list-item"><a href="/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;printable=yes" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li></ul>
		
	</div>
</nav>

	
<nav id="p-lang" class="mw-portlet mw-portlet-lang vector-menu vector-menu-portal portal" aria-labelledby="p-lang-label" role="navigation" 
	 >
	<label id="p-lang-label" aria-label="" class="vector-menu-heading">
		<span class="vector-menu-heading-label">In other languages</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		<div class="after-portlet after-portlet-lang"><span class="uls-after-portlet-link"></span><span class="wb-langlinks-add wb-langlinks-link"><a href="https://www.wikidata.org/wiki/Special:NewItem?site=enwikibooks&amp;page=C%2B%2B+Programming%2FCode%2FDesign+Patterns" title="Add interlanguage links" class="wbc-editpage">Add links</a></span></div>
	</div>
</nav>

</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 3 March 2019, at 14:54.</li>
	<li id="footer-info-copyright">Text is available under the <a href="//creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike License.</a>; additional terms may apply.  By using this site, you agree to the <a href="//foundation.wikimedia.org/wiki/Terms_of_Use">Terms of Use</a> and <a href="//foundation.wikimedia.org/wiki/Privacy_policy">Privacy Policy.</a></li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://foundation.wikimedia.org/wiki/Privacy_policy" class="extiw" title="wmf:Privacy policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="/wiki/Wikibooks:Welcome" title="Wikibooks:Welcome">About Wikibooks</a></li>
	<li id="footer-places-disclaimer"><a href="/wiki/Wikibooks:General_disclaimer" title="Wikibooks:General disclaimer">Disclaimers</a></li>
	<li id="footer-places-mobileview"><a href="//en.m.wikibooks.org/w/index.php?title=C%2B%2B_Programming/Code/Design_Patterns&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
	<li id="footer-places-developers"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/How_to_contribute">Developers</a></li>
	<li id="footer-places-statslink"><a href="https://stats.wikimedia.org/#/en.wikibooks.org">Statistics</a></li>
	<li id="footer-places-cookiestatement"><a href="https://foundation.wikimedia.org/wiki/Cookie_statement">Cookie statement</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://wikimediafoundation.org/"><img src="/static/images/footer/wikimedia-button.png" srcset="/static/images/footer/wikimedia-button-1.5x.png 1.5x, /static/images/footer/wikimedia-button-2x.png 2x" width="88" height="31" alt="Wikimedia Foundation" loading="lazy" /></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="/static/images/footer/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/static/images/footer/poweredby_mediawiki_132x47.png 1.5x, /static/images/footer/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.853","walltime":"9.097","ppvisitednodes":{"value":1409,"limit":1000000},"postexpandincludesize":{"value":41570,"limit":2097152},"templateargumentsize":{"value":4391,"limit":2097152},"expansiondepth":{"value":23,"limit":100},"expensivefunctioncount":{"value":0,"limit":500},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":523588,"limit":5000000},"entityaccesscount":{"value":0,"limit":400},"timingprofile":["100.00% 8501.007      1 -total"," 43.53% 3700.284      1 C++_Programming/Code/Design_Patterns/Behavioral_Patterns"," 29.34% 2493.811      1 C++_Programming/Code/Design_Patterns/Structural_Patterns"," 26.97% 2292.694      1 C++_Programming/Code/Design_Patterns/Creational_Patterns","  0.72%   61.034      4 Template:BOOKCAT","  0.52%   44.455      5 Template:Citation_needed","  0.48%   40.956      3 Template:Ifsubst","  0.43%   36.976      3 Template:Fix","  0.38%   32.604      3 Template:Cat_handler","  0.23%   19.856      4 Template:Evalx"]},"scribunto":{"limitreport-timeusage":{"value":"0.036","limit":"10.000"},"limitreport-memusage":{"value":1481946,"limit":52428800}},"cachereport":{"origin":"mw1350","timestamp":"20220315190629","ttl":1814400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":144,"wgHostname":"mw1399"});});</script>
</body>
</html>